schema: '2.0'
stages:
  clean-ratings:
    cmd: python ../run.py bx-extract.py ../data/BX-CSV-Dump.zip cleaned-ratings.csv
    deps:
    - path: ../data/BX-CSV-Dump.zip
      md5: 37d647ee9e18ba134ea6d78ee4fe5292
      size: 26085508
    - path: bx-extract.py
      md5: d90021e31eb39ee3b3470715043d270b
      size: 1297
    outs:
    - path: cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
  bx-cluster-ratings:
    cmd: python ../run.py --rust fusion bx-cluster-ratings.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 56ef5f842af3651da12b632886432122
      size: 152341832
    - path: ../book-links/isbn-clusters.parquet
      md5: a492385cb01a5ec059b5035ed703307c
      size: 162226729
    - path: bx-cluster-ratings.tcl
      md5: 661af7178a042f89125c816e0c66b739
      size: 407
    - path: cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    outs:
    - path: bx-cluster-ratings.parquet
      md5: 15042b137d55528192b998a0b65cf581
      size: 2818785
  bx-cluster-actions:
    cmd: python ../run.py --rust fusion bx-cluster-actions.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 56ef5f842af3651da12b632886432122
      size: 152341832
    - path: ../book-links/isbn-clusters.parquet
      md5: a492385cb01a5ec059b5035ed703307c
      size: 162226729
    - path: bx-cluster-actions.tcl
      md5: f06f2a9c19d319aa8802a15b092ac133
      size: 359
    - path: cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    outs:
    - path: bx-cluster-actions.parquet
      md5: b85f1f166708fd9bc68813a09ecad094
      size: 6246167
  cluster-ratings:
    cmd: python ../run.py bx-cluster-ratings.py
    deps:
    - path: ../book-links/isbn-clusters.parquet
      md5: 6c80d658cf126eecdae4fc5e963246a4
      size: 326819016
    - path: bx-cluster-ratings.py
      md5: b56ca5e07c97a70ce881e208b9cc6029
      size: 1133
    - path: cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    outs:
    - path: bx-cluster-ratings.parquet
      md5: 167e34b0c7f57677a162d1b5e87459a4
      size: 2864256
  cluster-actions:
    cmd: python ../run.py bx-cluster-actions.py
    deps:
    - path: ../book-links/isbn-clusters.parquet
      md5: 6c80d658cf126eecdae4fc5e963246a4
      size: 326819016
    - path: bx-cluster-actions.py
      md5: 46b8174ad84da270806f94e078ddb763
      size: 1019
    - path: cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    outs:
    - path: bx-cluster-actions.parquet
      md5: 0a6326c2c8b8be32311a2e30f6532023
      size: 6534401
  schema@bx-cluster-actions:
    cmd: python ../run.py --rust pq-info -o bx-cluster-actions.json bx-cluster-actions.parquet
    deps:
    - path: bx-cluster-actions.parquet
      md5: b7b1f16c6b6a107b6b6a218a63866dc6
      size: 6175087
    outs:
    - path: bx-cluster-actions.json
      md5: c7d7648d5df076ad2a1ce2d58cb48cac
      size: 331
  schema@bx-cluster-ratings:
    cmd: python ../run.py --rust pq-info -o bx-cluster-ratings.json bx-cluster-ratings.parquet
    deps:
    - path: bx-cluster-ratings.parquet
      md5: 6002f8294d60c0bb0f407e8c03b3f31b
      size: 2751030
    outs:
    - path: bx-cluster-ratings.json
      md5: cf86dba9da406bf93fce417349d8ee5b
      size: 420
