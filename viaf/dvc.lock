schema: '2.0'
stages:
  scan-authors:
    cmd: python ../run.py --rust scan-marc -L -o viaf.parquet ../data/viaf-clusters-marc21.xml.gz
    deps:
    - path: ../data/viaf-clusters-marc21.xml.gz
      md5: 83bfbacff8b72b5d4163c796941d6234
      size: 12655431316
    - path: ../src/cli/scan_marc.rs
      md5: 9d38cbfae708d25c13858a0c78150295
      size: 4115
    - path: ../src/marc
      md5: 139d8573d03645aa06f465fae8eda479.dir
      size: 21613
      nfiles: 5
    outs:
    - path: viaf.parquet
      md5: f19f4e31194e48fdca347038a9bb059b
      size: 11323008915
  author-names:
    cmd: python ../run.py --rust fusion author-names.tcl
    deps:
    - path: author-names.tcl
      md5: d0ebf76118c885cd85ce01ddc87cdb64
      size: 223
    - path: viaf.parquet
      md5: 8c93292c182dcfba2a5960eac57c6faa
      size: 12519632430
    outs:
    - path: author-names.csv.gz
      md5: 3823edd34fc084a9f8cef5cd8ec43da2
      size: 494355416
  author-genders:
    cmd: python ../run.py --rust filter-marc --tag=375 --subfield=a --trim --lower
      -n gender -o author-genders.parquet viaf.parquet
    deps:
    - path: ../src/cli/filter_marc.rs
      md5: 883b939e73d0bab8f8df3a22bb03bd1c
      size: 6358
    - path: viaf.parquet
      md5: f19f4e31194e48fdca347038a9bb059b
      size: 11323008915
    outs:
    - path: author-genders.parquet
      md5: d4333a9566a1b3a160d9682348c47570
      size: 115083637
  index-names:
    cmd: python ../run.py --rust index-names --marc-authorities viaf.parquet author-name-index.parquet
    deps:
    - path: ../src/cleaning/names
      md5: c5591171b9fef6a491e33b4b7f52ba2c.dir
      size: 10362
      nfiles: 5
    - path: ../src/cli/index_names.rs
      md5: 4b62b3a096ac42ab0c9e39436d0216ca
      size: 4004
    - path: viaf.parquet
      md5: f19f4e31194e48fdca347038a9bb059b
      size: 11323008915
    outs:
    - path: author-name-index.csv.gz
      md5: 174c6076ee4147cc5fdf8a89bc6dca11
      size: 657723008
    - path: author-name-index.parquet
      md5: b47599fdcf807564c1af96160437c604
      size: 516460534
  schema@author-name-index:
    cmd: python ../run.py --rust pq-info -o author-name-index.json author-name-index.parquet
    deps:
    - path: author-name-index.parquet
      md5: 254a39021dedbd8c7a994fd2c4fbdc67
      size: 516451943
    outs:
    - path: author-name-index.json
      md5: 4e608b7c650d04ed5e77c3fc3312b44d
      size: 247
  schema@viaf:
    cmd: python ../run.py --rust pq-info -o viaf.json viaf.parquet
    deps:
    - path: viaf.parquet
      md5: e267c52cb6ead92d5b51b80b3dcd28af
      size: 11318952681
    outs:
    - path: viaf.json
      md5: 55485f5bc2034323462fa644d92d820d
      size: 695
  schema@author-genders:
    cmd: python ../run.py --rust pq-info -o author-genders.json author-genders.parquet
    deps:
    - path: author-genders.parquet
      md5: f22e08510e3b70e749400b5019760350
      size: 115076921
    outs:
    - path: author-genders.json
      md5: e6ac261bc04b94f1ee581ae5ee31844f
      size: 249
