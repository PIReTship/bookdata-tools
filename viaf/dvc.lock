schema: '2.0'
stages:
  scan-authors:
    cmd: python ../run.py --rust scan-marc -L -o viaf.parquet ../data/viaf-clusters-marc21.xml.gz
    deps:
    - path: ../data/viaf-clusters-marc21.xml.gz
      md5: 83bfbacff8b72b5d4163c796941d6234
      size: 12655431316
    - path: ../src/cli/scan_marc.rs
      md5: b5bfacdfc9a22f40e59bb48fe74ecb4d
      size: 3668
    - path: ../src/marc
      md5: 066418c6e3db231224a89a97aa94da9f.dir
      size: 18604
      nfiles: 5
    outs:
    - path: viaf.parquet
      md5: 857cf0dfcab5fb725bb48030b82772c2
      size: 11320992492
  author-names:
    cmd: python ../run.py --rust fusion author-names.tcl
    deps:
    - path: author-names.tcl
      md5: d0ebf76118c885cd85ce01ddc87cdb64
      size: 223
    - path: viaf.parquet
      md5: 8c93292c182dcfba2a5960eac57c6faa
      size: 12519632430
    outs:
    - path: author-names.csv.gz
      md5: 3823edd34fc084a9f8cef5cd8ec43da2
      size: 494355416
  author-genders:
    cmd: python ../run.py --rust filter-marc --tag=375 --subfield=a --trim --lower
      -n gender -o author-genders.parquet viaf.parquet
    deps:
    - path: ../src/cli/filter_marc.rs
      md5: 31a19617859d1898366b35994304633d
      size: 5820
    - path: viaf.parquet
      md5: 857cf0dfcab5fb725bb48030b82772c2
      size: 11320992492
    outs:
    - path: author-genders.parquet
      md5: b27e2090ebe7ce18ace8efafc1c1def8
      size: 115079572
  index-names:
    cmd: python ../run.py --rust index-names --marc-authorities viaf.parquet author-name-index.parquet
    deps:
    - path: ../src/cleaning/names
      md5: bc2cfaeffef29d4e5e8f345322789c1d.dir
      size: 10331
      nfiles: 5
    - path: ../src/cli/index_names.rs
      md5: 03bef22b2df76d9a5fceb8c2f5dc0889
      size: 3807
    - path: viaf.parquet
      md5: 857cf0dfcab5fb725bb48030b82772c2
      size: 11320992492
    outs:
    - path: author-name-index.csv.gz
      md5: 9b3c58b4f6b59186379cb734a5ddbd34
      size: 657705598
    - path: author-name-index.parquet
      md5: 403bc43e24ebd020d9a652b69f79a11f
      size: 516463056
  schema@author-name-index:
    cmd: python ../run.py --rust pq-info -o author-name-index.json author-name-index.parquet
    deps:
    - path: author-name-index.parquet
      md5: 403bc43e24ebd020d9a652b69f79a11f
      size: 516463056
    outs:
    - path: author-name-index.json
      md5: 516314ecb8535fcc7dbfa184eb5ca13b
      size: 247
  schema@viaf:
    cmd: python ../run.py --rust pq-info -o viaf.json viaf.parquet
    deps:
    - path: viaf.parquet
      md5: 857cf0dfcab5fb725bb48030b82772c2
      size: 11320992492
    outs:
    - path: viaf.json
      md5: 62617d74bb6a7daddd26df21eb9783ed
      size: 695
  schema@author-genders:
    cmd: python ../run.py --rust pq-info -o author-genders.json author-genders.parquet
    deps:
    - path: author-genders.parquet
      md5: b27e2090ebe7ce18ace8efafc1c1def8
      size: 115079572
    outs:
    - path: author-genders.json
      md5: e9fd38df01a52fad83fc63bd8018d57d
      size: 249
