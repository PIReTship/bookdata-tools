schema: '2.0'
stages:
  scan-authors:
    cmd: python ../run.py --rust scan-marc -L -o viaf.parquet ../data/viaf-clusters-marc21.xml.gz
    deps:
    - path: ../data/viaf-clusters-marc21.xml.gz
      md5: 83bfbacff8b72b5d4163c796941d6234
      size: 12655431316
    - path: ../src/cli/scan_marc.rs
      md5: e49ae33c1f72c09aebb3efbd60425996
      size: 3612
    - path: ../src/marc
      md5: bbefbf50247770286d18c7648a6386cc.dir
      size: 17168
      nfiles: 5
    outs:
    - path: viaf.parquet
      md5: 7e249175d15aa2f08f85b21c42bd5dfc
      size: 11315602882
  author-names:
    cmd: python ../run.py --rust fusion author-names.tcl
    deps:
    - path: author-names.tcl
      md5: d0ebf76118c885cd85ce01ddc87cdb64
      size: 223
    - path: viaf.parquet
      md5: 8c93292c182dcfba2a5960eac57c6faa
      size: 12519632430
    outs:
    - path: author-names.csv.gz
      md5: 3823edd34fc084a9f8cef5cd8ec43da2
      size: 494355416
  author-genders:
    cmd: python ../run.py --rust filter-marc --tag=375 --subfield=a --trim --lower
      -n gender -o author-genders.parquet viaf.parquet
    deps:
    - path: ../src/cli/filter_marc.rs
      md5: 7d94df201a5145641b44056e5e755920
      size: 5915
    - path: viaf.parquet
      md5: 7e249175d15aa2f08f85b21c42bd5dfc
      size: 11315602882
    outs:
    - path: author-genders.parquet
      md5: b4e1240abcf43645fcf794db9c8db905
      size: 115070290
  index-names:
    cmd: python ../run.py --rust index-names --marc-authorities viaf.parquet author-name-index.parquet
    deps:
    - path: ../src/cleaning/names
      md5: bc2cfaeffef29d4e5e8f345322789c1d.dir
      size: 10331
      nfiles: 5
    - path: ../src/cli/index_names.rs
      md5: acd30ef2957ad31db3a634c176da4709
      size: 4174
    - path: viaf.parquet
      md5: 7e249175d15aa2f08f85b21c42bd5dfc
      size: 11315602882
    outs:
    - path: author-name-index.csv.gz
      md5: 58f412b11a8a212b2543f00c9b10213b
      size: 657709991
    - path: author-name-index.parquet
      md5: c2baa94007d9e6c3456312fbff9426b9
      size: 516468940
  schema@author-name-index:
    cmd: python ../run.py --rust pq-info -o author-name-index.json author-name-index.parquet
    deps:
    - path: author-name-index.parquet
      md5: 9e3cfbb8b0a005d6887fa095fd7d5002
      size: 533510259
    outs:
    - path: author-name-index.json
      md5: 3193c5de5175692f1803fc537ca1b694
      size: 351
  schema@viaf:
    cmd: python ../run.py --rust pq-info -o viaf.json viaf.parquet
    deps:
    - path: viaf.parquet
      md5: 8c93292c182dcfba2a5960eac57c6faa
      size: 12519632430
    outs:
    - path: viaf.json
      md5: a2bfdff4163aea05827f431c6e0d07a3
      size: 1059
  schema@author-genders:
    cmd: python ../run.py --rust pq-info -o author-genders.json author-genders.parquet
    deps:
    - path: author-genders.parquet
      md5: 67682ca913f02e9fa3321f9bb50bceeb
      size: 120612638
    outs:
    - path: author-genders.json
      md5: 8b664db76584c1331e14e91d3c87c81e
      size: 352
