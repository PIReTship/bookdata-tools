schema: '2.0'
stages:
  scan-books:
    cmd: python ../run.py --rust scan-marc --book-mode --glob "../data/loc-books/BooksAll.2016*.xml.gz"
    deps:
    - path: ../data/loc-books
      md5: 1b1e7ab1d98cc81e373dfc53345d4bb7.dir
      size: 3129774145
      nfiles: 43
    - path: ../src/cli/scan_marc.rs
      md5: 12a9d5d9854034367c903c5abb99d543
      size: 3557
    - path: ../src/marc
      md5: 3bf926388044e9dde1227a1b9c23774c.dir
      size: 16824
      nfiles: 5
    outs:
    - path: book-fields.parquet
      md5: 0d8c39ebc51b4d85dd897a7c2df91807
      size: 3094731731
    - path: book-ids.parquet
      md5: f2652363fca6916f022b57594db069ac
      size: 64554967
    - path: book-isbns.parquet
      md5: 2fa96b645a2a578bdd3004f04a3abeb0
      size: 54259876
  book-authors:
    cmd: python ../run.py --rust fusion book-authors.tcl
    deps:
    - path: book-authors.tcl
      md5: 76dd9093a7e1610f34513c447a92ba58
      size: 245
    - path: book-fields.parquet
      md5: 0d8c39ebc51b4d85dd897a7c2df91807
      size: 3094731731
    outs:
    - path: book-authors.parquet
      md5: 19829781bb046808ce772eed115e55fb
      size: 102117852
  scan-names:
    cmd: python ../run.py --rust scan-marc --glob "../data/loc-names/Names.2016*.xml.gz"
      -o name-fields.parquet
    deps:
    - path: ../data/loc-names
      md5: fc488a8775561070cced774803fe0d72.dir
      size: 1410755359
      nfiles: 40
    - path: ../src/cli/scan_marc.rs
      md5: 12a9d5d9854034367c903c5abb99d543
      size: 3557
    - path: ../src/marc
      md5: 3bf926388044e9dde1227a1b9c23774c.dir
      size: 16824
      nfiles: 5
    outs:
    - path: name-fields.parquet
      md5: bed1c8f92f0ebde5046e940426bdb4a5
      size: 1543059991
  author-names:
    cmd: python ../run.py --rust fusion author-names.tcl
    deps:
    - path: author-names.tcl
      md5: 29c68172aa2a10d6054b73656c21567c
      size: 193
    - path: name-fields.parquet
      md5: bed1c8f92f0ebde5046e940426bdb4a5
      size: 1543059991
    outs:
    - path: author-names.csv.gz
      md5: 030f7d4fbf2050e551bcaa6f1df38a25
      size: 87126106
  author-genders:
    cmd: python ../run.py --rust fusion author-genders.tcl
    deps:
    - path: author-genders.tcl
      md5: 58abbe4a110eb782450d9db0e461e087
      size: 197
    - path: name-fields.parquet
      md5: bed1c8f92f0ebde5046e940426bdb4a5
      size: 1543059991
    outs:
    - path: author-genders.csv.gz
      md5: 34e059515ad7c20efba25dde0cbb1988
      size: 1469549
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: d8369e4b05d4a7de9a8633c05a02012e
      size: 193645280
    - path: book-isbn-ids.tcl
      md5: 3633693602c7d0045687c23cb45b92e2
      size: 187
    - path: book-isbns.parquet
      md5: 2fa96b645a2a578bdd3004f04a3abeb0
      size: 54259876
    outs:
    - path: book-isbn-ids.parquet
      md5: 2b55000d38c1197f6b89aa6b2f63889c
      size: 46538580
  loc-clusters:
    cmd: python ../run.py --rust fusion loc-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: 7b235ae1a2bfbcd67e6146461d85f224
      size: 625090925
    - path: loc-clusters.tcl
      md5: 31716e72f6d58f047ea391109be5d806
      size: 221
    outs:
    - path: loc-clusters.parquet
      md5: 6dadb4444777907998b8251db2306f15
      size: 35698431
  schema@book-fields:
    cmd: python ../run.py --rust pq-info -o book-fields.json book-fields.parquet
    deps:
    - path: book-fields.parquet
      md5: 0d8c39ebc51b4d85dd897a7c2df91807
      size: 3094731731
    outs:
    - path: book-fields.json
      md5: 5b21bcafa8e78f9dad830c65e6f5e9a6
      size: 1057
  schema@book-isbn-ids:
    cmd: python ../run.py --rust pq-info -o book-isbn-ids.json book-isbn-ids.parquet
    deps:
    - path: book-isbn-ids.parquet
      md5: 2b55000d38c1197f6b89aa6b2f63889c
      size: 46538580
    outs:
    - path: book-isbn-ids.json
      md5: 12572d8a292bbece6ff9045d77bd21dc
      size: 353
  schema@book-ids:
    cmd: python ../run.py --rust pq-info -o book-ids.json book-ids.parquet
    deps:
    - path: book-ids.parquet
      md5: f2652363fca6916f022b57594db069ac
      size: 64554967
    outs:
    - path: book-ids.json
      md5: ec6755d763ff9b1e57989cbb627b7016
      size: 917
  schema@book-authors:
    cmd: python ../run.py --rust pq-info -o book-authors.json book-authors.parquet
    deps:
    - path: book-authors.parquet
      md5: 19829781bb046808ce772eed115e55fb
      size: 102117852
    outs:
    - path: book-authors.json
      md5: dac3758e814f1db9b7beda8c945f5a12
      size: 356
  schema@book-isbns:
    cmd: python ../run.py --rust pq-info -o book-isbns.json book-isbns.parquet
    deps:
    - path: book-isbns.parquet
      md5: 2fa96b645a2a578bdd3004f04a3abeb0
      size: 54259876
    outs:
    - path: book-isbns.json
      md5: 56d9e852eab806f5e10c79c4abf9dc24
      size: 485
  schema@loc-clusters:
    cmd: python ../run.py --rust pq-info -o loc-clusters.json loc-clusters.parquet
    deps:
    - path: loc-clusters.parquet
      md5: 6dadb4444777907998b8251db2306f15
      size: 35698431
    outs:
    - path: loc-clusters.json
      md5: a4949daba060b5a76aa31c1c4075c4d6
      size: 352
