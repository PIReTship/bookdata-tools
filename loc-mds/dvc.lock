schema: '2.0'
stages:
  scan-books:
    cmd: python ../run.py --rust scan-marc --book-mode --glob "../data/loc-books/BooksAll.2016*.xml.gz"
    deps:
    - path: ../data/loc-books
      md5: 1b1e7ab1d98cc81e373dfc53345d4bb7.dir
      size: 3129774145
      nfiles: 43
    - path: ../src/cli/scan_marc.rs
      md5: f15ec4f11916085bcc35d743bdfcf40e
      size: 3705
    - path: ../src/marc
      md5: bbefbf50247770286d18c7648a6386cc.dir
      size: 17168
      nfiles: 5
    outs:
    - path: book-authors.parquet
      md5: 3585eceab422d960e403a2a146bb0b5f
      size: 84128212
    - path: book-fields.parquet
      md5: e90234eba3c42a15c0514a5178d222d7
      size: 2703843200
    - path: book-ids.parquet
      md5: 38346ca168b32be26216dba43e5a6ef4
      size: 66927842
    - path: book-isbns.parquet
      md5: 9c3a216dbd6ae920ade9ed53eace8df6
      size: 56233310
  book-authors:
    cmd: python ../run.py --rust fusion book-authors.tcl
    deps:
    - path: book-authors.tcl
      md5: 56396f59e4ea77683b2af8e74d205a4f
      size: 250
    - path: book-fields.parquet
      md5: b305bde2a13f77c0cb62ed586574480c
      size: 3094731732
    outs:
    - path: book-authors.parquet
      md5: c46c8998dfdfd25b91c88b225a436466
      size: 100853758
  scan-names:
    cmd: python ../run.py --rust scan-marc --glob "../data/loc-names/Names.2016*.xml.gz"
      -o name-fields.parquet
    deps:
    - path: ../data/loc-names
      md5: fc488a8775561070cced774803fe0d72.dir
      size: 1410755359
      nfiles: 40
    - path: ../src/cli/scan_marc.rs
      md5: f15ec4f11916085bcc35d743bdfcf40e
      size: 3705
    - path: ../src/marc
      md5: 3bf926388044e9dde1227a1b9c23774c.dir
      size: 16824
      nfiles: 5
    outs:
    - path: name-fields.parquet
      md5: 800b068931bb1a2cba59b85b3ebf471d
      size: 1543059992
  author-names:
    cmd: python ../run.py --rust fusion author-names.tcl
    deps:
    - path: author-names.tcl
      md5: 29c68172aa2a10d6054b73656c21567c
      size: 193
    - path: name-fields.parquet
      md5: 800b068931bb1a2cba59b85b3ebf471d
      size: 1543059992
    outs:
    - path: author-names.csv.gz
      md5: 9e68c20496a2f62922334701f9e1492f
      size: 87125358
  author-genders:
    cmd: python ../run.py --rust fusion author-genders.tcl
    deps:
    - path: author-genders.tcl
      md5: 58abbe4a110eb782450d9db0e461e087
      size: 197
    - path: name-fields.parquet
      md5: 800b068931bb1a2cba59b85b3ebf471d
      size: 1543059992
    outs:
    - path: author-genders.csv.gz
      md5: 71a6ef56b674c032c5a572d478e66762
      size: 1469682
  book-isbn-ids:
    cmd: python ../run.py book-isbn-ids.py
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 853ac4693adcb143223a383ef65e69e3
      size: 272956344
    - path: book-isbn-ids.py
      md5: 56c43ad50e811fb2e8930180b75edcd4
      size: 1055
    - path: book-isbns.parquet
      md5: 9c3a216dbd6ae920ade9ed53eace8df6
      size: 56233310
    outs:
    - path: book-isbn-ids.parquet
      md5: 78f2fe5cf9b4dc4770576829e365bb3d
      size: 41912948
  loc-clusters:
    cmd: python ../run.py --rust fusion loc-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: 6d0ebe8ef88733428ac88a222f959b96
      size: 798139218
    - path: loc-clusters.tcl
      md5: 31716e72f6d58f047ea391109be5d806
      size: 221
    outs:
    - path: loc-clusters.parquet
      md5: 0748a8001c63142ebda3d099b6ebd84c
      size: 35754914
  schema@book-fields:
    cmd: python ../run.py --rust pq-info -o book-fields.json book-fields.parquet
    deps:
    - path: book-fields.parquet
      md5: b305bde2a13f77c0cb62ed586574480c
      size: 3094731732
    outs:
    - path: book-fields.json
      md5: cfad0181ee278196a575b5cc2259af9e
      size: 1057
  schema@book-isbn-ids:
    cmd: python ../run.py --rust pq-info -o book-isbn-ids.json book-isbn-ids.parquet
    deps:
    - path: book-isbn-ids.parquet
      md5: bde3b536165bf2e6f64393b2bb2f2d41
      size: 43725976
    outs:
    - path: book-isbn-ids.json
      md5: 68988c2a58ab9cfd0a27e638685b6237
      size: 353
  schema@book-ids:
    cmd: python ../run.py --rust pq-info -o book-ids.json book-ids.parquet
    deps:
    - path: book-ids.parquet
      md5: 3707a4a3955cb1a55f3c1acd68fc7454
      size: 64554968
    outs:
    - path: book-ids.json
      md5: 949285d6e61e016837c813c8a81b72fa
      size: 917
  schema@book-authors:
    cmd: python ../run.py --rust pq-info -o book-authors.json book-authors.parquet
    deps:
    - path: book-authors.parquet
      md5: c46c8998dfdfd25b91c88b225a436466
      size: 100853758
    outs:
    - path: book-authors.json
      md5: 7dd1e6123245e30c0faee6d0f3d96bae
      size: 356
  schema@book-isbns:
    cmd: python ../run.py --rust pq-info -o book-isbns.json book-isbns.parquet
    deps:
    - path: book-isbns.parquet
      md5: b6b4ebf2da3a565891160c3ab4bfcbc4
      size: 54259877
    outs:
    - path: book-isbns.json
      md5: 63af941253ba451737a5a2b07636d0a7
      size: 485
  schema@loc-clusters:
    cmd: python ../run.py --rust pq-info -o loc-clusters.json loc-clusters.parquet
    deps:
    - path: loc-clusters.parquet
      md5: 0748a8001c63142ebda3d099b6ebd84c
      size: 35754914
    outs:
    - path: loc-clusters.json
      md5: a9217be376ffffe877ee4f3a2f0dcbb9
      size: 352
