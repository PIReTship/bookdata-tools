schema: '2.0'
stages:
  collect-isbns:
    cmd: python run.py --rust collect-isbns
    deps:
    - path: az2014/ratings.parquet
      md5: 89d86c911899e74369ac742ed2a63107
      size: 139023869
    - path: bx/cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    - path: goodreads/gr-book-ids.parquet
      md5: 4d04a410735b0a6774f88940e8f60b22
      size: 41350691
    - path: loc-mds/book-isbns.parquet
      md5: 0758835c519af8c8596f56c3c04cdc5d
      size: 61305538
    - path: openlibrary/edition-isbns.parquet
      md5: cb17120e48b9787ed7be87f22fb250c8
      size: 163872537
    - path: src/bin/collect-isbns.rs
      md5: 622781b36fe4c74d94c22787d8d4ea29
      size: 4325
    outs:
    - path: book-links/all-isbns.parquet
      md5: 5528f328ba4738e3b645949650c33aa8
      size: 262549842
  cluster:
    cmd: python run.py --rust cluster-books
    deps:
    - path: book-links/all-isbns.parquet
      md5: 5528f328ba4738e3b645949650c33aa8
      size: 262549842
    - path: goodreads/book-isbn-ids.parquet
      md5: 74b425c4ccd37a429592c0adb86b4392
      size: 34939748
    - path: goodreads/gr-book-ids.parquet
      md5: 4d04a410735b0a6774f88940e8f60b22
      size: 41350691
    - path: loc-mds/book-ids.parquet
      md5: 0ecabde21c8cdcf31093ff10e6cc3dfb
      size: 73155576
    - path: loc-mds/book-isbn-ids.parquet
      md5: 37ef073d0cbda165da386e440895e995
      size: 73104112
    - path: openlibrary/all-works.parquet
      md5: 5b9ee7b6fc4af8469a9d38f2b53b7335
      size: 160433515
    - path: openlibrary/edition-isbn-ids.parquet
      md5: 01f91574924cc523562953cc1c64c7e2
      size: 225933880
    - path: openlibrary/edition-works.parquet
      md5: 5d70449a2c8c89dc050e2e6327855d28
      size: 175549574
    - path: openlibrary/editions.parquet
      md5: f96cd8279796a4ab0918b293a6affa71
      size: 148811683
    - path: src/bin/cluster-books.rs
      md5: aab3064132e95a57d56eddcf76174ad1
      size: 3928
    - path: src/graph/
      md5: 6239bfd494ce4e4a989d7f186245e00f.dir
      size: 9801
      nfiles: 4
    outs:
    - path: book-links/book-graph.mp.zst
      md5: e61df77db5512fa5264126a5e8e4ef36
      size: 776754707
    - path: book-links/cluster-graph-edges.parquet
      md5: 9fd8d87800cbaf35ec56f1ec8e86a46d
      size: 468283523
    - path: book-links/cluster-graph-nodes.parquet
      md5: 6e14f2b3fdf5b379d4218126d2f37f9c
      size: 717681121
    - path: book-links/cluster-stats.json
      md5: e9ba06013de5d347ffade428890296da
      size: 39
    - path: book-links/cluster-stats.parquet
      md5: f10def9bdd5ff16da9984ab8a3cf3de8
      size: 133693331
    - path: book-links/isbn-clusters.parquet
      md5: 7edb0b2a23bc9b7604d6b52b0d858f6e
      size: 296607353
  cluster-ol-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-ol-first-authors.parquet
      --first-author -s openlib
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: c1b27a37130afa2a02000db6a6f72560
      size: 161947431
    - path: openlibrary/author-names.parquet
      md5: 4e002793c585a769fc1334827697837e
      size: 142462847
    - path: openlibrary/edition-authors.parquet
      md5: 7172b92182942d728830cdac0b4862b6
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: afa5abff7a53ed402ba9ce4fb2a09635
      size: 214125175
    - path: src/bin/cluster-authors.rs
      md5: d32ee6761ce02761550716be04aff6ff
      size: 5058
    outs:
    - path: book-links/cluster-ol-first-authors.parquet
      md5: 904074c232f3b92b06d292a0bf5a59ba
      size: 157503615
  cluster-loc-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-loc-first-authors.parquet
      --first-author -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: c1b27a37130afa2a02000db6a6f72560
      size: 161947431
    - path: loc-mds/book-authors.parquet
      md5: 84e80cec0e0df87404a44a03d8d60bf3
      size: 127163262
    - path: loc-mds/book-isbn-ids.parquet
      md5: 6a764a693a9baad23d7c489cd3f7bfc9
      size: 70553002
    - path: src/bin/cluster-authors.rs
      md5: d32ee6761ce02761550716be04aff6ff
      size: 5058
    outs:
    - path: book-links/cluster-loc-first-authors.parquet
      md5: 7866d20f22fffacbe0775d4ca2e28dba
      size: 58848984
  cluster-irst-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-first-authors.parquet
      --first-author -s openlib -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: 5ee9bb4b67de722e24363e140ea2791f
      size: 161946382
    - path: loc-mds/book-authors.parquet
      md5: 2d3212dbf2405c48fb8bf2587a8587c3
      size: 127567010
    - path: loc-mds/book-isbn-ids.parquet
      md5: 6a764a693a9baad23d7c489cd3f7bfc9
      size: 70553002
    - path: openlibrary/author-names.parquet
      md5: 4e002793c585a769fc1334827697837e
      size: 142462847
    - path: openlibrary/edition-authors.parquet
      md5: 7172b92182942d728830cdac0b4862b6
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: afa5abff7a53ed402ba9ce4fb2a09635
      size: 214125175
    - path: src/bin/cluster-authors.rs
      md5: 76f614625858e7ad84e273e875861490
      size: 5253
    outs:
    - path: book-links/cluster-first-authors.parquet
      md5: a7f439659cccd809efe4ac2ea276b058
      size: 157637977
  cluster-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-first-authors.parquet
      --first-author -s openlib -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: c085060515ba8ada4bbf88da9d77992f
      size: 296607348
    - path: loc-mds/book-authors.parquet
      md5: 53994fff1611fe0429b81883e0439b0e
      size: 125793481
    - path: loc-mds/book-isbn-ids.parquet
      md5: 37ef073d0cbda165da386e440895e995
      size: 73104112
    - path: openlibrary/author-names.parquet
      md5: c898edae916f07fe90fce8c6e2e7c2b0
      size: 141892030
    - path: openlibrary/edition-authors.parquet
      md5: f4ecbe271442d4834b06c5cc0f2b5feb
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: 01f91574924cc523562953cc1c64c7e2
      size: 225933880
    - path: src/bin/cluster-authors.rs
      md5: d8bb6ef8de585d8cd2deb2b6dbd17bb0
      size: 5038
    outs:
    - path: book-links/cluster-first-authors.parquet
      md5: a3208ec91165eaef8419bef0d33bac8b
      size: 195616769
  cluster-genders:
    cmd: python run.py --rust cluster-author-gender -o book-links/cluster-genders.parquet
      -A book-links/cluster-first-authors.parquet
    deps:
    - path: book-links/cluster-first-authors.parquet
      md5: a3208ec91165eaef8419bef0d33bac8b
      size: 195616769
    - path: book-links/cluster-stats.parquet
      md5: 6d3a590a77543cc74037029fe00881a4
      size: 133623029
    - path: src/bin/cluster-author-gender/
      md5: a04a15876bc2eb5ff97448bb73f9792f.dir
      size: 7452
      nfiles: 3
    - path: viaf/author-genders.parquet
      md5: a7e3c869f8b444b8b0705d2e9bbf6dc2
      size: 148369290
    - path: viaf/author-name-index.parquet
      md5: 45307e4dad9dc4d9b4353d79c04f3195
      size: 521027574
    outs:
    - path: book-links/cluster-genders.parquet
      md5: ecf6618ee0a915a70bec16b738eae4ac
      size: 112929092
  gender-stats:
    cmd: python ../run.py --rust fusion integration-stats.tcl
    deps:
    - path: ../az2014/az-cluster-ratings.parquet
      md5: 7a75ebfa4fb3b5a93808293f6eebdbe0
      size: 217405818
    - path: ../bx/bx-cluster-actions.parquet
      md5: fd844ed804fd9d4a7762464dfe0ced71
      size: 3833750
    - path: ../bx/bx-cluster-ratings.parquet
      md5: 7f77282ad40ffb517a3b89aa5fda8238
      size: 1824338
    - path: ../goodreads/gr-cluster-actions.parquet
      md5: c3f2ca81dc530591ef172bacca7b0a51
      size: 815072618
    - path: ../goodreads/gr-cluster-ratings.parquet
      md5: 8964b416e6797c43b050a54432a522a3
      size: 323836602
    - path: ../loc-mds/book-isbn-ids.parquet
      md5: 37ef073d0cbda165da386e440895e995
      size: 73104112
    - path: cluster-genders.parquet
      md5: ecf6618ee0a915a70bec16b738eae4ac
      size: 112929092
    - path: integration-stats.tcl
      md5: 8e1047cc209458a45d73986002a43e01
      size: 1794
    - path: isbn-clusters.parquet
      md5: c085060515ba8ada4bbf88da9d77992f
      size: 296607348
    outs:
    - path: gender-stats.csv
      md5: 22c3889b0af31ae018f5f62a3ae0885d
      size: 1098
  cluster-hashes:
    cmd: python cluster-hash.py
    deps:
    - path: cluster-hash.py
      md5: 63af95d34bf99ca5feb58cce4a7715ee
      size: 762
    - path: isbn-clusters.parquet
      md5: 7641cf2bf32b14fdf57f08be8df9d23b
      size: 260471224
    outs:
    - path: cluster-hashes.parquet
      md5: a6d79fc94d5e066a6b14ceecaea29fd9
      size: 239512394
