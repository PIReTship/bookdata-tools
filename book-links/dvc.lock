schema: '2.0'
stages:
  collect-isbns:
    cmd: python run.py collect-isbns
    deps:
    - path: az2014/ratings.parquet
      md5: 9a3728f744585403cf8c5032a5d5f97f
      size: 139023869
    - path: bx/cleaned-ratings.csv
      md5: da3196d4af84ae39b3713e73c59677c7
      size: 22627884
    - path: goodreads/gr-book-ids.parquet
      md5: 622e4a02e329971ce79c4fc2423f7414
      size: 41353394
    - path: loc-mds/book-isbns.parquet
      md5: fe10b42e9099807fd3a555894f326cb9
      size: 61308859
    - path: openlibrary/edition-isbns.parquet
      md5: 5f0cfe2b912d5c3427c6e5145a4de618
      size: 163883427
    - path: scripts/collect-isbns.py
      md5: f8e72d3172510e93d538966002609e2a
      size: 2166
    outs:
    - path: book-links/all-isbns.parquet
      md5: 13e30d7304ca4c4d6bb6b6366b711df2
      size: 151844823
  cluster:
    cmd: python run.py --rust cluster-books
    deps:
    - path: book-links/all-isbns.parquet
      md5: 13e30d7304ca4c4d6bb6b6366b711df2
      size: 151844823
    - path: goodreads/book-isbn-ids.parquet
      md5: 4a1da5c7442908b8736528d77dd1d98b
      size: 34034504
    - path: goodreads/gr-book-ids.parquet
      md5: 622e4a02e329971ce79c4fc2423f7414
      size: 41353394
    - path: loc-mds/book-ids.parquet
      md5: bf1c5e34d1a21af873a5d6fc4a9c1385
      size: 73156551
    - path: loc-mds/book-isbn-ids.parquet
      md5: 87e334253b8181bf2cc2c237575b01c2
      size: 71436541
    - path: openlibrary/all-works.parquet
      md5: 0c63b9ca6e77c684d6916ac75d939e77
      size: 160430212
    - path: openlibrary/edition-isbn-ids.parquet
      md5: 444508be33d521b44c8f366f1ad93c7d
      size: 215882656
    - path: openlibrary/edition-works.parquet
      md5: 47a69f3ae12c330d321297e00e5d6efa
      size: 175549574
    - path: openlibrary/editions.parquet
      md5: 0cdeae4d581a4c7c04db4b41a8e1106c
      size: 148809247
    - path: src/bin/cluster-books.rs
      md5: 0a8abd273f37fb5c581cbe9843530024
      size: 2028
    outs:
    - path: book-links/book-graph.mp.zst
      md5: 5d2b39c49031e3a3dcf0814bc7b751dc
      size: 552575451
    - path: book-links/cluster-codes.parquet
      md5: 4e95b48d725cbf6b2e907f6f4fcc5919
      size: 552510575
    - path: book-links/cluster-stats.parquet
      md5: 3c7cacbf1c1969d4660a123c7f059988
      size: 116699446
    - path: book-links/isbn-clusters.parquet
      md5: 7641cf2bf32b14fdf57f08be8df9d23b
      size: 260471224
  cluster-ol-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-ol-first-authors.parquet
      --first-author -s openlib
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: c1b27a37130afa2a02000db6a6f72560
      size: 161947431
    - path: openlibrary/author-names.parquet
      md5: 4e002793c585a769fc1334827697837e
      size: 142462847
    - path: openlibrary/edition-authors.parquet
      md5: 7172b92182942d728830cdac0b4862b6
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: afa5abff7a53ed402ba9ce4fb2a09635
      size: 214125175
    - path: src/bin/cluster-authors.rs
      md5: d32ee6761ce02761550716be04aff6ff
      size: 5058
    outs:
    - path: book-links/cluster-ol-first-authors.parquet
      md5: 904074c232f3b92b06d292a0bf5a59ba
      size: 157503615
  cluster-loc-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-loc-first-authors.parquet
      --first-author -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: c1b27a37130afa2a02000db6a6f72560
      size: 161947431
    - path: loc-mds/book-authors.parquet
      md5: 84e80cec0e0df87404a44a03d8d60bf3
      size: 127163262
    - path: loc-mds/book-isbn-ids.parquet
      md5: 6a764a693a9baad23d7c489cd3f7bfc9
      size: 70553002
    - path: src/bin/cluster-authors.rs
      md5: d32ee6761ce02761550716be04aff6ff
      size: 5058
    outs:
    - path: book-links/cluster-loc-first-authors.parquet
      md5: 7866d20f22fffacbe0775d4ca2e28dba
      size: 58848984
  cluster-irst-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-first-authors.parquet
      --first-author -s openlib -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: 5ee9bb4b67de722e24363e140ea2791f
      size: 161946382
    - path: loc-mds/book-authors.parquet
      md5: 2d3212dbf2405c48fb8bf2587a8587c3
      size: 127567010
    - path: loc-mds/book-isbn-ids.parquet
      md5: 6a764a693a9baad23d7c489cd3f7bfc9
      size: 70553002
    - path: openlibrary/author-names.parquet
      md5: 4e002793c585a769fc1334827697837e
      size: 142462847
    - path: openlibrary/edition-authors.parquet
      md5: 7172b92182942d728830cdac0b4862b6
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: afa5abff7a53ed402ba9ce4fb2a09635
      size: 214125175
    - path: src/bin/cluster-authors.rs
      md5: 76f614625858e7ad84e273e875861490
      size: 5253
    outs:
    - path: book-links/cluster-first-authors.parquet
      md5: a7f439659cccd809efe4ac2ea276b058
      size: 157637977
  cluster-first-authors:
    cmd: python run.py --rust cluster-authors -o book-links/cluster-first-authors.parquet
      --first-author -s openlib -s loc
    deps:
    - path: book-links/isbn-clusters.parquet
      md5: 7641cf2bf32b14fdf57f08be8df9d23b
      size: 260471224
    - path: loc-mds/book-authors.parquet
      md5: ae51cb03c138cfdaae6073fb4cf29c54
      size: 127158444
    - path: loc-mds/book-isbn-ids.parquet
      md5: 87e334253b8181bf2cc2c237575b01c2
      size: 71436541
    - path: openlibrary/author-names.parquet
      md5: 1396172ca8687d7bb4934914591a653d
      size: 141987553
    - path: openlibrary/edition-authors.parquet
      md5: b073f79aa7818b502231ce195d917721
      size: 164027959
    - path: openlibrary/edition-isbn-ids.parquet
      md5: 444508be33d521b44c8f366f1ad93c7d
      size: 215882656
    - path: src/bin/cluster-authors.rs
      md5: 5c33eaa0e4027040fd1668d413af6b38
      size: 5015
    outs:
    - path: book-links/cluster-first-authors.parquet
      md5: 817cc59fc8610350505a31461f07fc8b
      size: 199285384
  cluster-genders:
    cmd: python run.py --rust cluster-author-gender -o book-links/cluster-genders.parquet
      -A book-links/cluster-first-authors.parquet
    deps:
    - path: book-links/cluster-first-authors.parquet
      md5: 817cc59fc8610350505a31461f07fc8b
      size: 199285384
    - path: book-links/cluster-stats.parquet
      md5: 3c7cacbf1c1969d4660a123c7f059988
      size: 116699446
    - path: src/bin/cluster-author-gender/
      md5: a04a15876bc2eb5ff97448bb73f9792f.dir
      size: 7452
      nfiles: 3
    - path: viaf/author-genders.parquet
      md5: a7e3c869f8b444b8b0705d2e9bbf6dc2
      size: 148369290
    - path: viaf/author-name-index.parquet
      md5: 45307e4dad9dc4d9b4353d79c04f3195
      size: 521027574
    outs:
    - path: book-links/cluster-genders.parquet
      md5: 409fa6355251b2fc4e2075b48229c60a
      size: 113253621
  gender-stats:
    cmd: python ../run.py --rust fusion integration-stats.tcl
    deps:
    - path: ../az2014/az-cluster-ratings.parquet
      md5: d3860885a7caf044d6c91f6bdfb991c7
      size: 260019565
    - path: ../bx/bx-cluster-actions.parquet
      md5: 902362b4ed221091cb9f5c8e6d2c6d2f
      size: 6281290
    - path: ../bx/bx-cluster-ratings.parquet
      md5: b73eeebc418328db77f3311cfd74bab6
      size: 2779767
    - path: ../goodreads/gr-cluster-actions.parquet
      md5: de525ce51de0996c385a0e60c021d951
      size: 2982324090
    - path: ../goodreads/gr-cluster-ratings.parquet
      md5: 85863f3c48ee91504e382a48ff550ec9
      size: 1372852573
    - path: ../loc-mds/book-isbn-ids.parquet
      md5: 87e334253b8181bf2cc2c237575b01c2
      size: 71436541
    - path: cluster-genders.parquet
      md5: 409fa6355251b2fc4e2075b48229c60a
      size: 113253621
    - path: integration-stats.tcl
      md5: 8e1047cc209458a45d73986002a43e01
      size: 1794
    - path: isbn-clusters.parquet
      md5: 7641cf2bf32b14fdf57f08be8df9d23b
      size: 260471224
    outs:
    - path: gender-stats.csv
      md5: 84b6f4e385a004519b31390d8615890c
      size: 1114
