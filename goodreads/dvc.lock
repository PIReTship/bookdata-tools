schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: fdc65b06c59b9e2cf647b40a432bb4db.dir
      size: 7122
      nfiles: 4
    - path: gr-book-link.parquet
      md5: a9603f2b4eb47fb124d3877cbaff7785
      size: 24816604
    outs:
    - path: gr-interactions.parquet
      md5: d6324acde5a5de2ef4a6207bf7f12e5a
      size: 2918239776
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: fdc65b06c59b9e2cf647b40a432bb4db.dir
      size: 7122
      nfiles: 4
    outs:
    - path: gr-book-ids.parquet
      md5: 32f46ee2566515e7452b41e111351a83
      size: 36149035
    - path: gr-book-info.parquet
      md5: fe606d0eb8061bb02ad810ea937a2d21
      size: 15217332
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: fdc65b06c59b9e2cf647b40a432bb4db.dir
      size: 7122
      nfiles: 4
    outs:
    - path: gr-work-info.parquet
      md5: fa8d30558e76e0329565c5c925cc86e8
      size: 24246109
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 7be23b16d06604f0520ea553c7b5a333
      size: 253066842
    - path: book-isbn-ids.tcl
      md5: cfc117dbae890985d5c9c3ac5ef650dd
      size: 470
    - path: gr-book-ids.parquet
      md5: 32f46ee2566515e7452b41e111351a83
      size: 36149035
    outs:
    - path: book-isbn-ids.parquet
      md5: 66c3152f72cc6c0db5ab6a473cf499f2
      size: 20855461
  cluster-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: a9603f2b4eb47fb124d3877cbaff7785
      size: 24816604
    - path: goodreads/gr-interactions.parquet
      md5: d6324acde5a5de2ef4a6207bf7f12e5a
      size: 2918239776
    - path: src/cli/cluster
      md5: 056f238677f83040450813b1376b21e3.dir
      size: 24282
      nfiles: 11
    - path: src/goodreads
      md5: fdc65b06c59b9e2cf647b40a432bb4db.dir
      size: 7122
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: 66432918ae7d824d03ee5756e34bfe1f
      size: 1400691227
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: b313a3946566668ef89cf88029e5e9f8
      size: 681044431
    - path: book-clusters.tcl
      md5: 8f54dc3fabb9b0720a6b7a8edae5485b
      size: 346
    - path: gr-book-ids.parquet
      md5: 32f46ee2566515e7452b41e111351a83
      size: 36149035
    outs:
    - path: gr-book-link.parquet
      md5: a9603f2b4eb47fb124d3877cbaff7785
      size: 24816604
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: a9603f2b4eb47fb124d3877cbaff7785
      size: 24816604
    - path: goodreads/gr-interactions.parquet
      md5: d6324acde5a5de2ef4a6207bf7f12e5a
      size: 2918239776
    - path: src/cli/cluster
      md5: 056f238677f83040450813b1376b21e3.dir
      size: 24282
      nfiles: 11
    - path: src/goodreads
      md5: fdc65b06c59b9e2cf647b40a432bb4db.dir
      size: 7122
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: be5e56cdc6d714404238aa864378e250
      size: 2917509726
  work-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings --native-works -o
      goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: d6324acde5a5de2ef4a6207bf7f12e5a
      size: 2918239776
    - path: src/cli/cluster
      md5: 056f238677f83040450813b1376b21e3.dir
      size: 24282
      nfiles: 11
    - path: src/ratings.rs
      md5: 830c05d7fe01f13db939ad198ee93339
      size: 7140
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: 466e98e304cfcea9db2a622ccd964319
      size: 1437919620
  work-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions --native-works -o
      goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: d6324acde5a5de2ef4a6207bf7f12e5a
      size: 2918239776
    - path: src/cli/cluster
      md5: 056f238677f83040450813b1376b21e3.dir
      size: 24282
      nfiles: 11
    - path: src/ratings.rs
      md5: 830c05d7fe01f13db939ad198ee93339
      size: 7140
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: 542f37d438bebaa8e7068b1f33f63d48
      size: 2971346039
  work-gender:
    cmd: python ../run.py --rust fusion work-gender.tcl
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: faf6392fcf4e1074251b6b74c688b221
      size: 115855267
    - path: gr-book-link.parquet
      md5: a9603f2b4eb47fb124d3877cbaff7785
      size: 24816604
    - path: work-gender.tcl
      md5: 0e1dc0a1bfaa8047a3686a318fd31d24
      size: 233
    outs:
    - path: gr-work-gender.parquet
      md5: cdd4a9019175eb7bcd0a3426c3044a6e
      size: 12296254
