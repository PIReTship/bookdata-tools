schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust gr-scan-interactions ../data/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/bin/gr-scan-interactions.rs
      md5: ae76a92eb876f8fc6d8041d2ab0c1da6
      size: 3305
    - path: gr-book-link.parquet
      md5: 6453145ee8b9ffa1171c43049adebd45
      size: 35784336
    outs:
    - path: gr-interactions.parquet
      md5: 6a1f1dac900788ffd6c8eea28478dcc9
      size: 3223833694
  scan-book-info:
    cmd: python ../run.py --rust gr-scan-book-info ../data/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/bin/gr-scan-book-info.rs
      md5: 7ece8f8853f86d9ff93e10ac7e1bd4e6
      size: 3208
    outs:
    - path: gr-book-ids.parquet
      md5: 622e4a02e329971ce79c4fc2423f7414
      size: 41353394
    - path: gr-book-info.parquet
      md5: 312a845d852cdc3b06449148513eaa8f
      size: 15586724
  scan-work-info:
    cmd: python ../run.py --rust gr-scan-works ../data/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/bin/gr-scan-works.rs
      md5: 94ae6c1f18906eeb735ff22f9cca2dbe
      size: 1833
    outs:
    - path: gr-work-info.parquet
      md5: 3fef786b4b9cf886a9cd02a9a48b47c0
      size: 24553263
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 13e30d7304ca4c4d6bb6b6366b711df2
      size: 151844823
    - path: book-isbn-ids.tcl
      md5: b3f86475231e429b7c5e2adfe626f321
      size: 452
    - path: gr-book-ids.parquet
      md5: 622e4a02e329971ce79c4fc2423f7414
      size: 41353394
    outs:
    - path: book-isbn-ids.parquet
      md5: 4a1da5c7442908b8736528d77dd1d98b
      size: 34034504
  cluster-ratings:
    cmd: python run.py --rust cluster-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 6a1f1dac900788ffd6c8eea28478dcc9
      size: 3223833694
    - path: src/bin/cluster-actions/
      md5: b49ab85f7fdc9c61b5e43d5829c8d8cc.dir
      size: 8986
      nfiles: 5
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: 1f159bfdf3986bf71323e765c04f2565
      size: 1372750263
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-codes.parquet
      md5: 4e95b48d725cbf6b2e907f6f4fcc5919
      size: 552510575
    - path: book-clusters.tcl
      md5: 24d1043f07d9aa5e13e447c8cdd1f7b5
      size: 339
    - path: gr-book-ids.parquet
      md5: 622e4a02e329971ce79c4fc2423f7414
      size: 41353394
    outs:
    - path: gr-book-link.parquet
      md5: 6453145ee8b9ffa1171c43049adebd45
      size: 35784336
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 6a1f1dac900788ffd6c8eea28478dcc9
      size: 3223833694
    - path: src/bin/cluster-actions/
      md5: b49ab85f7fdc9c61b5e43d5829c8d8cc.dir
      size: 8986
      nfiles: 5
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: ddd34d87fc4f52a509fdbfd893f5b8aa
      size: 2982234987
  work-ratings:
    cmd: python run.py --rust cluster-actions -s gr-ratings --native-works -o goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 6a1f1dac900788ffd6c8eea28478dcc9
      size: 3223833694
    - path: src/bin/cluster-actions/
      md5: b49ab85f7fdc9c61b5e43d5829c8d8cc.dir
      size: 8986
      nfiles: 5
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: cf1903ec5d47060286f5c363cd831b6c
      size: 1415452276
  work-actions:
    cmd: python run.py --rust cluster-actions -s gr-actions --native-works -o goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 6a1f1dac900788ffd6c8eea28478dcc9
      size: 3223833694
    - path: src/bin/cluster-actions/
      md5: b49ab85f7fdc9c61b5e43d5829c8d8cc.dir
      size: 8986
      nfiles: 5
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: 074f143a3e9b2f88ffa6ae3285c415d0
      size: 3046665776
