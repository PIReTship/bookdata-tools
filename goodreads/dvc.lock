schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: cd25337eceafa2f9d80d77331f427019.dir
      size: 8017
      nfiles: 4
    - path: gr-book-link.parquet
      md5: 4e04808d4d75ab0a53d9dfbd92266518
      size: 24505649
    outs:
    - path: gr-interactions.parquet
      md5: 70b07c63103b4526d8eb79649fb75597
      size: 4751653010
    - path: gr-users.parquet
      md5: 564cdcd43d76ff2e12a5605c0be97517
      size: 17818325
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: cd25337eceafa2f9d80d77331f427019.dir
      size: 8017
      nfiles: 4
    outs:
    - path: gr-book-ids.parquet
      md5: 2d887e7c73eeacd0beb672675fbb66e2
      size: 36149035
    - path: gr-book-info.parquet
      md5: 856f85a807a3cee565565b354656434e
      size: 15217332
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: 68265950321e96c8da549e0f306a67b6
      size: 1984
    - path: ../src/goodreads
      md5: cd25337eceafa2f9d80d77331f427019.dir
      size: 8017
      nfiles: 4
    outs:
    - path: gr-work-info.parquet
      md5: fc0c1b10867d22af8f04118d60c33319
      size: 24246109
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: c3a11dd6da1fd30bcb49f22f6c91a771
      size: 253050236
    - path: book-isbn-ids.tcl
      md5: cfc117dbae890985d5c9c3ac5ef650dd
      size: 470
    - path: gr-book-ids.parquet
      md5: 2d887e7c73eeacd0beb672675fbb66e2
      size: 36149035
    outs:
    - path: book-isbn-ids.parquet
      md5: d4353e72929e8981c78b2240bc3b980d
      size: 20862352
  cluster-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 4e04808d4d75ab0a53d9dfbd92266518
      size: 24505649
    - path: goodreads/gr-interactions.parquet
      md5: 70b07c63103b4526d8eb79649fb75597
      size: 4751653010
    - path: src/cli/cluster
      md5: 24246dfd1e31a6b9d0d20fab2dfb5321.dir
      size: 25155
      nfiles: 11
    - path: src/goodreads
      md5: cd25337eceafa2f9d80d77331f427019.dir
      size: 8017
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: 742bc379b2aa530aa64c287d7df1392a
      size: 1400672686
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: dffd723dbe720c8b2364c61323ebedd9
      size: 680616057
    - path: book-clusters.tcl
      md5: 8f54dc3fabb9b0720a6b7a8edae5485b
      size: 356
    - path: gr-book-ids.parquet
      md5: 2d887e7c73eeacd0beb672675fbb66e2
      size: 36149035
    outs:
    - path: gr-book-link.parquet
      md5: 4e04808d4d75ab0a53d9dfbd92266518
      size: 24505649
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 4e04808d4d75ab0a53d9dfbd92266518
      size: 24505649
    - path: goodreads/gr-interactions.parquet
      md5: 70b07c63103b4526d8eb79649fb75597
      size: 4751653010
    - path: src/cli/cluster
      md5: 24246dfd1e31a6b9d0d20fab2dfb5321.dir
      size: 25155
      nfiles: 11
    - path: src/goodreads
      md5: cd25337eceafa2f9d80d77331f427019.dir
      size: 8017
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: 37f68ee546d7daf3a575e15243e94a3e
      size: 2917513134
  work-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings --native-works -o
      goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 70b07c63103b4526d8eb79649fb75597
      size: 4751653010
    - path: src/cli/cluster
      md5: 24246dfd1e31a6b9d0d20fab2dfb5321.dir
      size: 25155
      nfiles: 11
    - path: src/ratings.rs
      md5: 830c05d7fe01f13db939ad198ee93339
      size: 7140
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: f06e30b57193b97111b6ff2b62810f94
      size: 1437907536
  work-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions --native-works -o
      goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 70b07c63103b4526d8eb79649fb75597
      size: 4751653010
    - path: src/cli/cluster
      md5: 24246dfd1e31a6b9d0d20fab2dfb5321.dir
      size: 25155
      nfiles: 11
    - path: src/ratings.rs
      md5: 830c05d7fe01f13db939ad198ee93339
      size: 7140
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: f458641890a85fc18015747f6bef7fcd
      size: 2971309254
  work-gender:
    cmd: python ../run.py --rust fusion work-gender.tcl
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: 1ac0ddb9abab3147fd8ad17b6271569d
      size: 115796820
    - path: gr-book-link.parquet
      md5: 4e04808d4d75ab0a53d9dfbd92266518
      size: 24505649
    - path: work-gender.tcl
      md5: 0e1dc0a1bfaa8047a3686a318fd31d24
      size: 233
    outs:
    - path: gr-work-gender.parquet
      md5: ca439dc25353c9ba9d045b835770fb3d
      size: 12296824
