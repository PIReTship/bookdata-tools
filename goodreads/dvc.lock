schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: 6e8b2eb0a252735147c5c7ff1774b456
      size: 2170
    - path: ../src/goodreads
      md5: 554c1384d9836ea980213058c61d7ec6.dir
      size: 8950
      nfiles: 4
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
    outs:
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: gr-users.parquet
      md5: ff0d06650a9944bf80cc8c4a99827c1d
      size: 18683237
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: 6e8b2eb0a252735147c5c7ff1774b456
      size: 2170
    - path: ../src/goodreads
      md5: 554c1384d9836ea980213058c61d7ec6.dir
      size: 8950
      nfiles: 4
    outs:
    - path: gr-book-ids.parquet
      md5: b29c1441c2377d98a803c0cc38b0bc33
      size: 37758445
    - path: gr-book-info.parquet
      md5: 31355888192010795ee0dfd372f10bbf
      size: 15146396
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: 6e8b2eb0a252735147c5c7ff1774b456
      size: 2170
    - path: ../src/goodreads
      md5: 554c1384d9836ea980213058c61d7ec6.dir
      size: 8950
      nfiles: 4
    outs:
    - path: gr-work-info.parquet
      md5: 3ebd5a6f7578e3dad3b8654efe9f9704
      size: 21630942
  book-isbn-ids:
    cmd: python ../run.py book-isbn-ids.py
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 853ac4693adcb143223a383ef65e69e3
      size: 272956344
    - path: book-isbn-ids.py
      md5: 5463cb77d6e9f3affafa7fdeedd30357
      size: 1403
    - path: gr-book-ids.parquet
      md5: b29c1441c2377d98a803c0cc38b0bc33
      size: 37758445
    outs:
    - path: book-isbn-ids.parquet
      md5: b9fb172668966850787fc8f28942dc73
      size: 23955222
  cluster-ratings:
    cmd: python ../run.py gr-cluster-interactions.py --ratings -o gr-cluster-ratings.parquet
    deps:
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
    - path: gr-cluster-interactions.py
      md5: 8d0b11f69d6a0f558570ce36c8bcb585
      size: 2601
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-cluster-ratings.parquet
      md5: 904a891b61264a23b41db79861981a2e
      size: 1566991672
  book-links:
    cmd: python ../run.py book-clusters.py
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: 90570ae8ad8b92cd7408b2e93438280d
      size: 838775657
    - path: book-clusters.py
      md5: 1f17e792b7898ce02879e0a86e88c186
      size: 1010
    - path: gr-book-ids.parquet
      md5: b29c1441c2377d98a803c0cc38b0bc33
      size: 37758445
    outs:
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python ../run.py gr-cluster-interactions.py --add-actions -o gr-cluster-actions.parquet
    deps:
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
    - path: gr-cluster-interactions.py
      md5: 8d0b11f69d6a0f558570ce36c8bcb585
      size: 2601
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-cluster-actions.parquet
      md5: e613613e003bf16c7ef1917351fb4929
      size: 1498267178
  work-ratings:
    cmd: python ../run.py gr-cluster-interactions.py --native-works --ratings -o gr-work-ratings.parquet
    deps:
    - path: gr-cluster-interactions.py
      md5: 8d0b11f69d6a0f558570ce36c8bcb585
      size: 2601
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-work-ratings.parquet
      md5: 0d9f519acad4d8f1b94dafc54bace4a3
      size: 1640676645
  work-actions:
    cmd: python ../run.py gr-cluster-interactions.py --native-works --add-actions
      -o gr-work-actions.parquet
    deps:
    - path: gr-cluster-interactions.py
      md5: 8d0b11f69d6a0f558570ce36c8bcb585
      size: 2601
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-work-actions.parquet
      md5: a15faa45f6b956f93a7795b453d946e8
      size: 1569601498
  work-gender:
    cmd: python ../run.py work-gender.py
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: 0d4f082d25ba22055ae3064353ccd184
      size: 125958140
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
    - path: work-gender.py
      md5: b16a48973d63c5faaf99919a8d80ea30
      size: 674
    outs:
    - path: gr-work-gender.parquet
      md5: edd7326f594e0f6de22022e6c2b8907a
      size: 28728115
  schema@gr-work-gender:
    cmd: python ../run.py --rust pq-info -o gr-work-gender.json gr-work-gender.parquet
    deps:
    - path: gr-work-gender.parquet
      md5: edd7326f594e0f6de22022e6c2b8907a
      size: 28728115
    outs:
    - path: gr-work-gender.json
      md5: f5a4e6c22af80c5d3179f58dc1f814b9
      size: 423
  schema@gr-work-info:
    cmd: python ../run.py --rust pq-info -o gr-work-info.json gr-work-info.parquet
    deps:
    - path: gr-work-info.parquet
      md5: 3ebd5a6f7578e3dad3b8654efe9f9704
      size: 21630942
    outs:
    - path: gr-work-info.json
      md5: 53032fe59b518f9d06a4ff04ccb1e118
      size: 517
  schema@gr-work-actions:
    cmd: python ../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: a15faa45f6b956f93a7795b453d946e8
      size: 1569601498
    outs:
    - path: gr-work-actions.json
      md5: fbd53ff95cd17f34166e93c8b039cb07
      size: 618
  schema@gr-work-ratings:
    cmd: python ../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: 0d9f519acad4d8f1b94dafc54bace4a3
      size: 1640676645
    outs:
    - path: gr-work-ratings.json
      md5: 77c0c065962ddeee0d183dae1ac1e897
      size: 708
  schema@gr-book-info:
    cmd: python ../run.py --rust pq-info -o gr-book-info.json gr-book-info.parquet
    deps:
    - path: gr-book-info.parquet
      md5: 31355888192010795ee0dfd372f10bbf
      size: 15146396
    outs:
    - path: gr-book-info.json
      md5: af0d725e807d1e6b320851dbf144ce9f
      size: 518
  schema@book-isbn-ids:
    cmd: python ../run.py --rust pq-info -o book-isbn-ids.json book-isbn-ids.parquet
    deps:
    - path: book-isbn-ids.parquet
      md5: b9fb172668966850787fc8f28942dc73
      size: 23955222
    outs:
    - path: book-isbn-ids.json
      md5: 700d20d51380cb5241227b4db9b6f0c6
      size: 249
  schema@gr-interactions:
    cmd: python ../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-interactions.json
      md5: 9b3af7db2bcd5cb7616d6f0a17daefb4
      size: 990
  schema@gr-book-ids:
    cmd: python ../run.py --rust pq-info -o gr-book-ids.json gr-book-ids.parquet
    deps:
    - path: gr-book-ids.parquet
      md5: b29c1441c2377d98a803c0cc38b0bc33
      size: 37758445
    outs:
    - path: gr-book-ids.json
      md5: 9b7fd900a00eb12f94ae887d48f0f638
      size: 507
  schema@gr-cluster-ratings:
    cmd: python ../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: 904a891b61264a23b41db79861981a2e
      size: 1566991672
    outs:
    - path: gr-cluster-ratings.json
      md5: a3826ac91829a65da0c6dbcc46d4fa3c
      size: 707
  schema@gr-users:
    cmd: python ../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: ff0d06650a9944bf80cc8c4a99827c1d
      size: 18683237
    outs:
    - path: gr-users.json
      md5: 70a463f659828f45949b5288557788f7
      size: 244
  schema@gr-book-link:
    cmd: python ../run.py --rust pq-info -o gr-book-link.json gr-book-link.parquet
    deps:
    - path: gr-book-link.parquet
      md5: ae56e7b2e5bd8b640a97003577c6a3df
      size: 20427503
    outs:
    - path: gr-book-link.json
      md5: ea8b409961c515e070ee9ef929c745ae
      size: 336
  schema@gr-cluster-actions:
    cmd: python ../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: e613613e003bf16c7ef1917351fb4929
      size: 1498267178
    outs:
    - path: gr-cluster-actions.json
      md5: da97e84db3638c22f351e147d70abda7
      size: 617
