schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: 04f76699d96acb044b4d0e1b86943832
      size: 2164
    - path: ../src/goodreads
      md5: c0e1188b29e0478d181890c499d30b96.dir
      size: 8673
      nfiles: 4
    - path: gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
    outs:
    - path: gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    - path: gr-users.parquet
      md5: 5f71a3381f6432304dc1e00b3616c692
      size: 17863618
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: 04f76699d96acb044b4d0e1b86943832
      size: 2164
    - path: ../src/goodreads
      md5: c0e1188b29e0478d181890c499d30b96.dir
      size: 8673
      nfiles: 4
    outs:
    - path: gr-book-ids.parquet
      md5: 40d3f3a5914f546c0f71cadf696e8072
      size: 36138262
    - path: gr-book-info.parquet
      md5: e45e45c4d02bcbe40c4a97328301ab58
      size: 15209465
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: 04f76699d96acb044b4d0e1b86943832
      size: 2164
    - path: ../src/goodreads
      md5: c0e1188b29e0478d181890c499d30b96.dir
      size: 8673
      nfiles: 4
    outs:
    - path: gr-work-info.parquet
      md5: 25a3e2e13e6003da4cdf4df4eed7b169
      size: 24205522
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: f0b746d69f8beb9d099180a62e12531f
      size: 253341052
    - path: book-isbn-ids.tcl
      md5: cfc117dbae890985d5c9c3ac5ef650dd
      size: 454
    - path: gr-book-ids.parquet
      md5: 40d3f3a5914f546c0f71cadf696e8072
      size: 36138262
    outs:
    - path: book-isbn-ids.parquet
      md5: 774b1df89365ef458083ad8204d21ea6
      size: 19538322
  cluster-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
    - path: goodreads/gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    - path: src/cli/cluster
      md5: d5d0e8cce43b9655f682aca7d959f7c2.dir
      size: 25433
      nfiles: 11
    - path: src/goodreads
      md5: c0e1188b29e0478d181890c499d30b96.dir
      size: 8673
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: 72f3e8fbe33e5977219006f8161248f6
      size: 1385712463
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: 6d0ebe8ef88733428ac88a222f959b96
      size: 798139218
    - path: book-clusters.tcl
      md5: 8f54dc3fabb9b0720a6b7a8edae5485b
      size: 346
    - path: gr-book-ids.parquet
      md5: 40d3f3a5914f546c0f71cadf696e8072
      size: 36138262
    outs:
    - path: gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
    - path: goodreads/gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    - path: src/cli/cluster
      md5: d5d0e8cce43b9655f682aca7d959f7c2.dir
      size: 25433
      nfiles: 11
    - path: src/goodreads
      md5: c0e1188b29e0478d181890c499d30b96.dir
      size: 8673
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: 0646032c031fea4a948624d27af84ace
      size: 2892057603
  work-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings --native-works -o
      goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    - path: src/cli/cluster
      md5: d5d0e8cce43b9655f682aca7d959f7c2.dir
      size: 25433
      nfiles: 11
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: e628b37126a150370aa23647aa5eecff
      size: 1438041016
  work-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions --native-works -o
      goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    - path: src/cli/cluster
      md5: d5d0e8cce43b9655f682aca7d959f7c2.dir
      size: 25433
      nfiles: 11
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: c4d9c50a5e1468f0eeaafb5f5e8a8d21
      size: 2971354857
  work-gender:
    cmd: python ../run.py --rust fusion work-gender.tcl
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: ba64b849da8517699f7b9092beb0bb7c
      size: 126233190
    - path: gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
    - path: work-gender.tcl
      md5: 0e1dc0a1bfaa8047a3686a318fd31d24
      size: 233
    outs:
    - path: gr-work-gender.parquet
      md5: 36cb8ce6808bfe102069577fc111e6bf
      size: 11884078
  schema@gr-work-gender:
    cmd: python ../run.py --rust pq-info -o gr-work-gender.json gr-work-gender.parquet
    deps:
    - path: gr-work-gender.parquet
      md5: 36cb8ce6808bfe102069577fc111e6bf
      size: 11884078
    outs:
    - path: gr-work-gender.json
      md5: 6b7eb2f38b4520476cd4d9cd1d1508fa
      size: 492
  schema@gr-work-info:
    cmd: python ../run.py --rust pq-info -o gr-work-info.json gr-work-info.parquet
    deps:
    - path: gr-work-info.parquet
      md5: 25a3e2e13e6003da4cdf4df4eed7b169
      size: 24205522
    outs:
    - path: gr-work-info.json
      md5: b8f2579dd0557acee9587365ab6cf1a3
      size: 777
  schema@gr-work-actions:
    cmd: python ../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: c4d9c50a5e1468f0eeaafb5f5e8a8d21
      size: 2971354857
    outs:
    - path: gr-work-actions.json
      md5: 7e4abe4a26b7daa75381f27c20631e5d
      size: 930
  schema@gr-work-ratings:
    cmd: python ../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: e628b37126a150370aa23647aa5eecff
      size: 1438041016
    outs:
    - path: gr-work-ratings.json
      md5: ad5d5397a50c0dbcd7a813b8453f02d6
      size: 1073
  schema@gr-book-info:
    cmd: python ../run.py --rust pq-info -o gr-book-info.json gr-book-info.parquet
    deps:
    - path: gr-book-info.parquet
      md5: e45e45c4d02bcbe40c4a97328301ab58
      size: 15209465
    outs:
    - path: gr-book-info.json
      md5: 872f6cc6cad66437b6bfaa73e94d00cc
      size: 778
  schema@book-isbn-ids:
    cmd: python ../run.py --rust pq-info -o book-isbn-ids.json book-isbn-ids.parquet
    deps:
    - path: book-isbn-ids.parquet
      md5: 774b1df89365ef458083ad8204d21ea6
      size: 19538322
    outs:
    - path: book-isbn-ids.json
      md5: 72bf12098a0fc9d290b8faf5f817b307
      size: 353
  schema@gr-interactions:
    cmd: python ../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: c73cb2bae7711b088016712a4c9a353d
      size: 4427843940
    outs:
    - path: gr-interactions.json
      md5: cddc7272faeb0982ec045f9027ac9f5f
      size: 1510
  schema@gr-book-ids:
    cmd: python ../run.py --rust pq-info -o gr-book-ids.json gr-book-ids.parquet
    deps:
    - path: gr-book-ids.parquet
      md5: 40d3f3a5914f546c0f71cadf696e8072
      size: 36138262
    outs:
    - path: gr-book-ids.json
      md5: 81621e2d65eed337aac447657eedbb18
      size: 767
  schema@gr-cluster-ratings:
    cmd: python ../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: 72f3e8fbe33e5977219006f8161248f6
      size: 1385712463
    outs:
    - path: gr-cluster-ratings.json
      md5: ad5bba63aba701c1f381d7b049434d01
      size: 1072
  schema@gr-users:
    cmd: python ../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: 5f71a3381f6432304dc1e00b3616c692
      size: 17863618
    outs:
    - path: gr-users.json
      md5: 377f52f809898a1bc125547a7fb65912
      size: 350
  schema@gr-book-link:
    cmd: python ../run.py --rust pq-info -o gr-book-link.json gr-book-link.parquet
    deps:
    - path: gr-book-link.parquet
      md5: 6d31a96c5c1c57ebdff16ceb784f70f6
      size: 24108455
    outs:
    - path: gr-book-link.json
      md5: a4d0c45d98199ec45396fc2240285054
      size: 494
  schema@gr-cluster-actions:
    cmd: python ../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: 0646032c031fea4a948624d27af84ace
      size: 2892057603
    outs:
    - path: gr-cluster-actions.json
      md5: a4cc42d68706071931acbff561a12169
      size: 930
  scan-short-interactions:
    cmd: python ../run.py --rust goodreads scan interactions --book-map ../data/goodreads/book_id_map.csv
      ../data/goodreads/goodreads_interactions.csv
    deps:
    - path: ../data/goodreads/book_id_map.csv
      md5: c4e5afd568df2f7a4a8a52f3eeb88413
      size: 37846957
    - path: ../data/goodreads/goodreads_interactions.csv
      md5: 696fbf71f0082c0b6a2379182b147c1e
      size: 4318621741
    - path: ../src/cli/goodreads.rs
      md5: bd9d1ce8f723e1f3d1773abd5cae21e6
      size: 4002
    - path: ../src/goodreads
      md5: cffeb7225bb8abdaf7b7a02300bff4e7.dir
      size: 11108
      nfiles: 4
    outs:
    - path: gr-short-interactions.parquet
      md5: a17474d902f2cff72a1c2782d6af23b2
      size: 1491471897
