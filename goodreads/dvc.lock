schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust gr-scan-interactions ../data/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/bin/gr-scan-interactions.rs
      md5: 7a5f7a64465a32a2ec785ee6783d4d23
      size: 3894
    - path: gr-book-link.parquet
      md5: 3bbd6f480f9174cdf16032b16558c060
      size: 26455219
    outs:
    - path: gr-interactions.parquet
      md5: 58f6942aee4c42a1d336a2e8421a9daa
      size: 3902709131
  scan-book-info:
    cmd: python ../run.py --rust gr-scan-book-info ../data/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/bin/gr-scan-book-info.rs
      md5: b1f9ad1bdce56f0f410398db64f3d4a4
      size: 3010
    outs:
    - path: gr-book-ids.parquet
      md5: 64a5908f7b1d7cb302294b20d40716ff
      size: 41334427
    - path: gr-book-info.parquet
      md5: 9f7a645917c77f8ac56c9a4637acb3af
      size: 15586724
  scan-work-info:
    cmd: python ../run.py --rust gr-scan-works ../data/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/bin/gr-scan-works.rs
      md5: fbdc5fd74d772b66154c7641c9c803d9
      size: 1825
    outs:
    - path: gr-work-info.parquet
      md5: e20e598be6ffbc840cca7441980ff0f6
      size: 24553263
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: 6e3981bc8feeb857d10cbb8984cc67d9
      size: 152341829
    - path: book-isbn-ids.tcl
      md5: b3f86475231e429b7c5e2adfe626f321
      size: 452
    - path: gr-book-ids.parquet
      md5: 64a5908f7b1d7cb302294b20d40716ff
      size: 41334427
    outs:
    - path: book-isbn-ids.parquet
      md5: 37220d3c416ce090b2a303f018c7a6f2
      size: 33672437
  cluster-ratings:
    cmd: python ../run.py --rust fusion gr-cluster-ratings.tcl
    deps:
    - path: ../book-links/isbn-clusters.parquet
      md5: a492385cb01a5ec059b5035ed703307c
      size: 162226729
    - path: book-isbn-ids.parquet
      md5: 3bd0b5b98aea888a7e5c83632f3d756f.dir
      size: 31552279
      nfiles: 48
    - path: gr-cluster-ratings.tcl
      md5: 4e983d5c1d6825019a804ab478c6ce35
      size: 426
    - path: gr-interactions.parquet
      md5: e8185970b48c63abcb30d37b15c46836
      size: 1660088652
    outs:
    - path: gr-cluster-ratings.parquet
      md5: 0069e4f45fe48606a8b164134be0bab5
      size: 1014
  book-links:
    cmd: python ../run.py book-clusters.py
    deps:
    - path: ../book-links/isbn-clusters.parquet
      md5: 5ee9bb4b67de722e24363e140ea2791f
      size: 161946382
    - path: book-clusters.py
      md5: aa57913d5010a84eeb1b053b3e1b0640
      size: 1250
    - path: book-isbn-ids.parquet
      md5: 37220d3c416ce090b2a303f018c7a6f2
      size: 33672437
    - path: gr-book-ids.parquet
      md5: 64a5908f7b1d7cb302294b20d40716ff
      size: 41334427
    outs:
    - path: gr-book-link.parquet
      md5: 3bbd6f480f9174cdf16032b16558c060
      size: 26455219
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python cluster-actions.py
    deps:
    - path: cluster-actions.py
      md5: 8ad007bbaed89417f3812590124d801c
      size: 1536
    - path: gr-interactions.parquet
      md5: 58f6942aee4c42a1d336a2e8421a9daa
      size: 3902709131
    outs:
    - path: gr-cluster-actions.parquet
      md5: c5b4f13d152a925c9f48fc5b1c9d57bd
      size: 2799033666
