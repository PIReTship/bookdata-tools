schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: 4e1628a2f874242c7b7ffb25b3e1be78
      size: 1967
    - path: ../src/goodreads
      md5: 8b3b4168effce4c951781d00b1ffc3e1.dir
      size: 8283
      nfiles: 4
    - path: gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
    outs:
    - path: gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    - path: gr-users.parquet
      md5: 2612f812fa8d9bfccc812ac0a5acad6a
      size: 17877562
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: 4e1628a2f874242c7b7ffb25b3e1be78
      size: 1967
    - path: ../src/goodreads
      md5: 8b3b4168effce4c951781d00b1ffc3e1.dir
      size: 8283
      nfiles: 4
    outs:
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    - path: gr-book-info.parquet
      md5: f63af49e3f7fdf2e5063adc621847e80
      size: 15214486
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: 4e1628a2f874242c7b7ffb25b3e1be78
      size: 1967
    - path: ../src/goodreads
      md5: 8b3b4168effce4c951781d00b1ffc3e1.dir
      size: 8283
      nfiles: 4
    outs:
    - path: gr-work-info.parquet
      md5: bd67414879d0cfb486b3e349f0b52379
      size: 24237773
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: f6b9fb8398a05d56c012dd4064471470
      size: 253193862
    - path: book-isbn-ids.tcl
      md5: cfc117dbae890985d5c9c3ac5ef650dd
      size: 454
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    outs:
    - path: book-isbn-ids.parquet
      md5: 4aabb0e7caf711db3863f357355f7c05
      size: 19115272
  cluster-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
    - path: goodreads/gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    - path: src/cli/cluster
      md5: a1d600e4111815f34cd366be955d3f8f.dir
      size: 24990
      nfiles: 11
    - path: src/goodreads
      md5: 8b3b4168effce4c951781d00b1ffc3e1.dir
      size: 8283
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: e68579a1056843d151aaf53d7ce437f2
      size: 1385735303
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: f1eb9bf3276988a1958d0b6bdd339eeb
      size: 797739654
    - path: book-clusters.tcl
      md5: 8f54dc3fabb9b0720a6b7a8edae5485b
      size: 346
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    outs:
    - path: gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
    - path: goodreads/gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    - path: src/cli/cluster
      md5: a1d600e4111815f34cd366be955d3f8f.dir
      size: 24990
      nfiles: 11
    - path: src/goodreads
      md5: 8b3b4168effce4c951781d00b1ffc3e1.dir
      size: 8283
      nfiles: 4
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: b93a9d944fd0daa0eac77181d34a0f7a
      size: 2892082036
  work-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings --native-works -o
      goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    - path: src/cli/cluster
      md5: a1d600e4111815f34cd366be955d3f8f.dir
      size: 24990
      nfiles: 11
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: 5b7b179ce5d448482de69c7486b2b3ae
      size: 1438013754
  work-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions --native-works -o
      goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    - path: src/cli/cluster
      md5: a1d600e4111815f34cd366be955d3f8f.dir
      size: 24990
      nfiles: 11
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: a9753c0b5a4120665f28a809e80a16a2
      size: 2971334594
  work-gender:
    cmd: python ../run.py --rust fusion work-gender.tcl
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: 9a36ceabf406a6930a5cd6b3b1d90f92
      size: 126895725
    - path: gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
    - path: work-gender.tcl
      md5: 0e1dc0a1bfaa8047a3686a318fd31d24
      size: 233
    outs:
    - path: gr-work-gender.parquet
      md5: 9a235699519b0a4e9c92ebc3314d0810
      size: 12228931
  schema@gr-work-gender:
    cmd: python ../run.py --rust pq-info -o gr-work-gender.json gr-work-gender.parquet
    deps:
    - path: gr-work-gender.parquet
      md5: 9a235699519b0a4e9c92ebc3314d0810
      size: 12228931
    outs:
    - path: gr-work-gender.json
      md5: 306aadad77669a1296335c45eef04acb
      size: 492
  schema@gr-work-info:
    cmd: python ../run.py --rust pq-info -o gr-work-info.json gr-work-info.parquet
    deps:
    - path: gr-work-info.parquet
      md5: bd67414879d0cfb486b3e349f0b52379
      size: 24237773
    outs:
    - path: gr-work-info.json
      md5: 3baaa27a44b6df6738af365db5442c41
      size: 777
  schema@gr-work-actions:
    cmd: python ../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: a9753c0b5a4120665f28a809e80a16a2
      size: 2971334594
    outs:
    - path: gr-work-actions.json
      md5: 5b93b604da2477b370d91c707f319838
      size: 930
  schema@gr-work-ratings:
    cmd: python ../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: 5b7b179ce5d448482de69c7486b2b3ae
      size: 1438013754
    outs:
    - path: gr-work-ratings.json
      md5: fcd8c00d6eb2e2b47e6f7a21f579951b
      size: 1073
  schema@gr-book-info:
    cmd: python ../run.py --rust pq-info -o gr-book-info.json gr-book-info.parquet
    deps:
    - path: gr-book-info.parquet
      md5: f63af49e3f7fdf2e5063adc621847e80
      size: 15214486
    outs:
    - path: gr-book-info.json
      md5: 5d6a12aca8f60f2280e429346870f9d8
      size: 778
  schema@book-isbn-ids:
    cmd: python ../run.py --rust pq-info -o book-isbn-ids.json book-isbn-ids.parquet
    deps:
    - path: book-isbn-ids.parquet
      md5: 4aabb0e7caf711db3863f357355f7c05
      size: 19115272
    outs:
    - path: book-isbn-ids.json
      md5: 9e3ad9d32906a3c8d27ac577e07b8852
      size: 353
  schema@gr-interactions:
    cmd: python ../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: 1f87196384ab3eb86874d07fba4a0a5d
      size: 4427843939
    outs:
    - path: gr-interactions.json
      md5: db2d18dda7b346bbb488639728fc81e5
      size: 1510
  schema@gr-book-ids:
    cmd: python ../run.py --rust pq-info -o gr-book-ids.json gr-book-ids.parquet
    deps:
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    outs:
    - path: gr-book-ids.json
      md5: 817cb24d594d1a42249257bba41c0303
      size: 767
  schema@gr-cluster-ratings:
    cmd: python ../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: e68579a1056843d151aaf53d7ce437f2
      size: 1385735303
    outs:
    - path: gr-cluster-ratings.json
      md5: c75e5b6b63d9d9dae53d29a16c3f78c3
      size: 1072
  schema@gr-users:
    cmd: python ../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: 2612f812fa8d9bfccc812ac0a5acad6a
      size: 17877562
    outs:
    - path: gr-users.json
      md5: 8b30a578eed2081ad89f6666e13a6762
      size: 350
  schema@gr-book-link:
    cmd: python ../run.py --rust pq-info -o gr-book-link.json gr-book-link.parquet
    deps:
    - path: gr-book-link.parquet
      md5: 41d78ff0c68d27caeb84f74705c31fdd
      size: 24186004
    outs:
    - path: gr-book-link.json
      md5: 2e074697734a18ffcca99cb9e51e925a
      size: 494
  schema@gr-cluster-actions:
    cmd: python ../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: b93a9d944fd0daa0eac77181d34a0f7a
      size: 2892082036
    outs:
    - path: gr-cluster-actions.json
      md5: 4623e802038729d905ed15b35152aa56
      size: 930
