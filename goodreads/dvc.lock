schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../run.py --rust goodreads scan interactions ../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../src/cli/goodreads.rs
      md5: e0f5844200ccd996ca80026c804ea86a
      size: 2190
    - path: ../src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    - path: gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
    outs:
    - path: gr-interactions.parquet
      md5: b42248e16b7545d8dbe44859e18e4b4a
      size: 5740494373
    - path: gr-users.parquet
      md5: eb16c198761b5fa9b4793a19e9bc3874
      size: 17817105
  scan-book-info:
    cmd: python ../run.py --rust goodreads scan books ../data/goodreads/goodreads_books.json.gz
    deps:
    - path: ../data/goodreads/goodreads_books.json.gz
      md5: 01b40c70a00fb6aa321ee478f0fd0d6b
      size: 2043729443
    - path: ../src/cli/goodreads.rs
      md5: e0f5844200ccd996ca80026c804ea86a
      size: 2190
    - path: ../src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    outs:
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    - path: gr-book-info.parquet
      md5: f63af49e3f7fdf2e5063adc621847e80
      size: 15214486
  scan-work-info:
    cmd: python ../run.py --rust goodreads scan works ../data/goodreads/goodreads_book_works.json.gz
    deps:
    - path: ../data/goodreads/goodreads_book_works.json.gz
      md5: e80738a88d02d2b0081cd249d9b4f081
      size: 81412944
    - path: ../src/cli/goodreads.rs
      md5: e0f5844200ccd996ca80026c804ea86a
      size: 2190
    - path: ../src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    outs:
    - path: gr-work-info.parquet
      md5: bd67414879d0cfb486b3e349f0b52379
      size: 24237773
  book-isbn-ids:
    cmd: python ../run.py --rust fusion book-isbn-ids.tcl
    deps:
    - path: ../book-links/all-isbns.parquet
      md5: bda703683918b4a95a8c030d98ce9568
      size: 200094613
    - path: book-isbn-ids.tcl
      md5: cfc117dbae890985d5c9c3ac5ef650dd
      size: 454
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    outs:
    - path: book-isbn-ids.parquet
      md5: c578d7dd4c54f46d2e460ddacd3b9db2
      size: 19254938
  cluster-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings -o goodreads/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
    - path: goodreads/gr-interactions.parquet
      md5: b42248e16b7545d8dbe44859e18e4b4a
      size: 5740494373
    - path: src/cli/cluster
      md5: 5ac10b25260ff8d4e5e4d27cf71d8622.dir
      size: 25125
      nfiles: 11
    - path: src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    outs:
    - path: goodreads/gr-cluster-ratings.parquet
      md5: 63d2157bdcd2064a0577285bd97ae183
      size: 1579420230
  book-links:
    cmd: python ../run.py --rust fusion book-clusters.tcl
    deps:
    - path: ../book-links/cluster-graph-nodes.parquet
      md5: 67121a9be444ab56e7f72d61ffab6b24
      size: 630847820
    - path: book-clusters.tcl
      md5: 8f54dc3fabb9b0720a6b7a8edae5485b
      size: 346
    - path: gr-book-ids.parquet
      md5: bd138e1db016e3533554f08971ed28eb
      size: 36155423
    outs:
    - path: gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
  cluster-interactions:
    cmd: python cluster-ratings.py
    deps:
    - path: cluster-ratings.py
      md5: d44be03784268f02b28c1b40bc108c27
      size: 1219
    - path: gr-book-link.parquet
      md5: f31fc29c8644c439e192af9868604a93
      size: 29380146
    - path: gr-interactions.parquet
      md5: 0ee400ec374aa0263198b25e9d9140e0
      size: 1619196241
    outs:
    - path: gr-cluster-ratings.parquet
      md5: af8b42db6e3b8f0ded896f7cab433530
      size: 327784394
  cluster-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions -o goodreads/gr-cluster-actions.parquet
    deps:
    - path: goodreads/gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
    - path: goodreads/gr-interactions.parquet
      md5: b42248e16b7545d8dbe44859e18e4b4a
      size: 5740494373
    - path: src/cli/cluster
      md5: 5ac10b25260ff8d4e5e4d27cf71d8622.dir
      size: 25125
      nfiles: 11
    - path: src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    outs:
    - path: goodreads/gr-cluster-actions.parquet
      md5: d3a4dedfc90c67f59501c87cbbd2d7fd
      size: 3318026447
  work-ratings:
    cmd: python run.py --rust cluster group-actions -s gr-ratings --native-works -o
      goodreads/gr-work-ratings.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: b42248e16b7545d8dbe44859e18e4b4a
      size: 5740494373
    - path: src/cli/cluster
      md5: 5ac10b25260ff8d4e5e4d27cf71d8622.dir
      size: 25125
      nfiles: 11
    outs:
    - path: goodreads/gr-work-ratings.parquet
      md5: 3373a0faec8ed7e48d1716b435cf2a14
      size: 1623009969
  work-actions:
    cmd: python run.py --rust cluster group-actions -s gr-actions --native-works -o
      goodreads/gr-work-actions.parquet
    deps:
    - path: goodreads/gr-interactions.parquet
      md5: b42248e16b7545d8dbe44859e18e4b4a
      size: 5740494373
    - path: src/cli/cluster
      md5: 5ac10b25260ff8d4e5e4d27cf71d8622.dir
      size: 25125
      nfiles: 11
    outs:
    - path: goodreads/gr-work-actions.parquet
      md5: b4b456e10fb4245c7dfca6b3d342d8e4
      size: 3381456956
  work-gender:
    cmd: python ../run.py --rust fusion work-gender.tcl
    deps:
    - path: ../book-links/cluster-genders.parquet
      md5: 0a8ae5a6729e16a35d070f9870180d36
      size: 109945682
    - path: gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
    - path: work-gender.tcl
      md5: 0e1dc0a1bfaa8047a3686a318fd31d24
      size: 233
    outs:
    - path: gr-work-gender.parquet
      md5: bf664422cf2699b30c264d8ce4b73dce
      size: 12060997
  scan-reviews:
    cmd: python ../run.py --rust goodreads scan reviews ../data/goodreads/goodreads_reviews_dedup.json.gz
    deps:
    - path: ../data/goodreads/goodreads_reviews_dedup.json.gz
      md5: bdd95c4f92691df3d311012254988a1e
      size: 5343299228
    - path: ../src/cli/goodreads.rs
      md5: e0f5844200ccd996ca80026c804ea86a
      size: 2190
    - path: ../src/goodreads
      md5: ec14e7be64adb8c38dac8b854b98d441.dir
      size: 10401
      nfiles: 5
    - path: gr-book-link.parquet
      md5: 58f580f86283adc19bfde9e651357485
      size: 24583035
    outs:
    - path: gr-reviews.parquet
      md5: 6b02e6af27e183fe44d340c885770928
      size: 4991027540
