schema: '2.0'
stages:
  scan-interactions:
    cmd: cargo run --release -- goodreads scan interactions ../../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_interactions.json.gz
      hash: md5
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../../src/cli/goodreads
      hash: md5
      md5: ce11f1d45035c404d99e7315a442a4d6.dir
      size: 12638
      nfiles: 4
    - path: ../../src/goodreads
      hash: md5
      md5: 8410919a029aca229d678e2cbe4be4ea.dir
      size: 22314
      nfiles: 10
    outs:
    - path: gr-interactions.parquet
      hash: md5
      md5: b30430653770266a99921696af2d4044
      size: 4587488091
    - path: gr-users.parquet
      hash: md5
      md5: ceb6314193b9a242df2a4db02e39f639
      size: 18637038
  cluster-actions:
    cmd: cargo run --release -- goodreads cluster-interactions --add-actions -o goodreads/full/gr-cluster-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      hash: md5
      md5: b30430653770266a99921696af2d4044
      size: 4587488091
    - path: goodreads/gr-book-link.parquet
      hash: md5
      md5: 8e49ada76ecc01cdae0689723c275061
      size: 19983670
    - path: src/cli/goodreads/cluster.rs
      hash: md5
      md5: 1e40bcc70bdcbba5fc50dc283342a621
      size: 7588
    outs:
    - path: goodreads/full/gr-cluster-actions.parquet
      hash: md5
      md5: f3970fc9c9e91c82fc1b95919bb08518
      size: 2708959255
  cluster-actions-5core:
    cmd: cargo run --release -- kcore -o gr-cluster-actions-5core.parquet gr-cluster-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-cluster-actions.parquet
      hash: md5
      md5: f3970fc9c9e91c82fc1b95919bb08518
      size: 2708959255
    outs:
    - path: gr-cluster-actions-5core.parquet
      hash: md5
      md5: da66e9d527ec871c5120f802e39602c9
      size: 2694359811
  cluster-ratings:
    cmd: cargo run --release -- goodreads cluster-interactions --ratings -o goodreads/full/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      hash: md5
      md5: b30430653770266a99921696af2d4044
      size: 4587488091
    - path: goodreads/gr-book-link.parquet
      hash: md5
      md5: 8e49ada76ecc01cdae0689723c275061
      size: 19983670
    - path: src/cli/goodreads/cluster.rs
      hash: md5
      md5: 1e40bcc70bdcbba5fc50dc283342a621
      size: 7588
    outs:
    - path: goodreads/full/gr-cluster-ratings.parquet
      hash: md5
      md5: 5f3f521233636fca535bd6d90c06a9a6
      size: 1369092099
  cluster-ratings-5core:
    cmd: cargo run --release -- kcore -o gr-cluster-ratings-5core.parquet gr-cluster-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-cluster-ratings.parquet
      hash: md5
      md5: 5f3f521233636fca535bd6d90c06a9a6
      size: 1369092099
    outs:
    - path: gr-cluster-ratings-5core.parquet
      hash: md5
      md5: fbaf68c42ea5f7eb1b6075f741ec6fa3
      size: 1346945376
  work-actions:
    cmd: cargo run --release -- goodreads cluster-interactions --add-actions --native-works
      -o goodreads/full/gr-work-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      hash: md5
      md5: b30430653770266a99921696af2d4044
      size: 4587488091
    - path: goodreads/gr-book-link.parquet
      hash: md5
      md5: 8e49ada76ecc01cdae0689723c275061
      size: 19983670
    - path: src/cli/goodreads/cluster.rs
      hash: md5
      md5: 1e40bcc70bdcbba5fc50dc283342a621
      size: 7588
    outs:
    - path: goodreads/full/gr-work-actions.parquet
      hash: md5
      md5: a4ff8cda8c454206c132d424def625bf
      size: 2808211029
  work-actions-2015-100-10core:
    cmd: cargo run --release -- kcore --user-k 10 --item-k 100 --year 2015 -o gr-work-actions-2015-100-10core.parquet
      gr-work-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-work-actions.parquet
      hash: md5
      md5: a4ff8cda8c454206c132d424def625bf
      size: 2808211029
    outs:
    - path: gr-work-actions-2015-100-10core.parquet
      hash: md5
      md5: 17a6f55301fd3624f3ba88df5d43cb23
      size: 177343891
  work-actions-5core:
    cmd: cargo run --release -- kcore -o gr-work-actions-5core.parquet gr-work-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-work-actions.parquet
      hash: md5
      md5: a4ff8cda8c454206c132d424def625bf
      size: 2808211029
    outs:
    - path: gr-work-actions-5core.parquet
      hash: md5
      md5: 9c872f74922ce2a8f8722a25e4a6cef8
      size: 2793741107
  work-ratings:
    cmd: cargo run --release -- goodreads cluster-interactions --ratings --native-works
      -o goodreads/full/gr-work-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      hash: md5
      md5: b30430653770266a99921696af2d4044
      size: 4587488091
    - path: goodreads/gr-book-link.parquet
      hash: md5
      md5: 8e49ada76ecc01cdae0689723c275061
      size: 19983670
    - path: src/cli/goodreads/cluster.rs
      hash: md5
      md5: 1e40bcc70bdcbba5fc50dc283342a621
      size: 7588
    outs:
    - path: goodreads/full/gr-work-ratings.parquet
      hash: md5
      md5: aee6e039d526a27c07f52e97d533d549
      size: 1434210227
  work-ratings-2015-100-10core:
    cmd: cargo run --release -- kcore --user-k 10 --item-k 100 --year 2015 -o gr-work-ratings-2015-100-10core.parquet
      gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-work-ratings.parquet
      hash: md5
      md5: aee6e039d526a27c07f52e97d533d549
      size: 1434210227
    outs:
    - path: gr-work-ratings-2015-100-10core.parquet
      hash: md5
      md5: 306a03d3caf3774e8cfdc4da47886b2e
      size: 5153861
  work-ratings-5core:
    cmd: cargo run --release -- kcore -o gr-work-ratings-5core.parquet gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      hash: md5
      md5: 9a64f2beb19d2053d9c2386609beafe9
      size: 4874
    - path: gr-work-ratings.parquet
      hash: md5
      md5: aee6e039d526a27c07f52e97d533d549
      size: 1434210227
    outs:
    - path: gr-work-ratings-5core.parquet
      hash: md5
      md5: 8d50e6035b908d5f0098e790173478e7
      size: 1412324069
  scan-reviews:
    cmd: cargo run --release -- goodreads scan reviews ../../data/goodreads/goodreads_reviews_dedup.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_reviews_dedup.json.gz
      hash: md5
      md5: bdd95c4f92691df3d311012254988a1e
      size: 5343299228
    - path: ../../src/cli/goodreads
      hash: md5
      md5: ce11f1d45035c404d99e7315a442a4d6.dir
      size: 12638
      nfiles: 4
    - path: ../../src/goodreads
      hash: md5
      md5: 8410919a029aca229d678e2cbe4be4ea.dir
      size: 22314
      nfiles: 10
    - path: ../gr-book-link.parquet
      hash: md5
      md5: 8e49ada76ecc01cdae0689723c275061
      size: 19983670
    - path: gr-users.parquet
      hash: md5
      md5: ceb6314193b9a242df2a4db02e39f639
      size: 18637038
    outs:
    - path: gr-reviews.parquet
      hash: md5
      md5: 121eadf17b5b37fb695fc31ed8abe594
      size: 4513321076
