schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../../run.py --rust goodreads scan interactions ../../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../../src/cli/goodreads
      md5: 2083d583e9d78e0c244d722902417157.dir
      size: 12128
      nfiles: 4
    - path: ../../src/goodreads
      md5: 49baa19c011307b48ca3fb6e29c777d6.dir
      size: 17036
      nfiles: 7
    outs:
    - path: gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: gr-users.parquet
      md5: 25cbde2dbce33211b73bdcb80b74b142
      size: 18613573
  schema@gr-interactions:
    cmd: python ../../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    outs:
    - path: gr-interactions.json
      md5: 7cc12504c0217ddfb85a1eba578814fb
      size: 990
  work-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions --native-works
      -o goodreads/full/gr-work-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 50a9230841b77e3f0b97bf6f0db7e1cf
      size: 7429
    outs:
    - path: goodreads/full/gr-work-actions.parquet
      md5: cbf8cc3e65b8637d2a2d999584f48269
      size: 2915943647
  schema@gr-work-actions:
    cmd: python ../../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: cbf8cc3e65b8637d2a2d999584f48269
      size: 2915943647
    outs:
    - path: gr-work-actions.json
      md5: 600fdc51355b7f4de88afbb1310926dc
      size: 614
  cluster-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings -o goodreads/full/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 50a9230841b77e3f0b97bf6f0db7e1cf
      size: 7429
    outs:
    - path: goodreads/full/gr-cluster-ratings.parquet
      md5: 04ba4d82ef46b6b31f683a33d80f862f
      size: 1363835205
  schema@gr-cluster-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: 04ba4d82ef46b6b31f683a33d80f862f
      size: 1363835205
    outs:
    - path: gr-cluster-ratings.json
      md5: 83c7ab47c2d05cf8a8c4c383c862f7df
      size: 703
  cluster-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions -o goodreads/full/gr-cluster-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 50a9230841b77e3f0b97bf6f0db7e1cf
      size: 7429
    outs:
    - path: goodreads/full/gr-cluster-actions.parquet
      md5: 86e0429f43d387fc86748330704b0734
      size: 2812604300
  schema@gr-cluster-actions:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: 86e0429f43d387fc86748330704b0734
      size: 2812604300
    outs:
    - path: gr-cluster-actions.json
      md5: ccb6277f8f9f5599fe20a3d3bb9ded4e
      size: 614
  work-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings --native-works
      -o goodreads/full/gr-work-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 50a9230841b77e3f0b97bf6f0db7e1cf
      size: 7429
    outs:
    - path: goodreads/full/gr-work-ratings.parquet
      md5: d9000709e7aee430b230abb118bc9abd
      size: 1427661225
  schema@gr-work-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: d9000709e7aee430b230abb118bc9abd
      size: 1427661225
    outs:
    - path: gr-work-ratings.json
      md5: 4be0653504833e2fdd7c174f1426a142
      size: 704
  schema@gr-users:
    cmd: python ../../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: 25cbde2dbce33211b73bdcb80b74b142
      size: 18613573
    outs:
    - path: gr-users.json
      md5: cd33f9936cb1ef3a5819c8ae24e1f110
      size: 244
  cluster-ratings-5core:
    cmd: python ../../run.py --rust kcore -o gr-cluster-ratings-5core.parquet gr-cluster-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: 1687cd58ba626b4585a38ffca547d380
      size: 3490
    - path: gr-cluster-ratings.parquet
      md5: 04ba4d82ef46b6b31f683a33d80f862f
      size: 1363835205
    outs:
    - path: gr-cluster-ratings-5core.parquet
      md5: 0e86d01d3890e8655b8ea01535d615aa
      size: 1340926399
  work-actions-5core:
    cmd: python ../../run.py --rust kcore -o gr-work-actions-5core.parquet gr-work-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: 1687cd58ba626b4585a38ffca547d380
      size: 3490
    - path: gr-work-actions.parquet
      md5: cbf8cc3e65b8637d2a2d999584f48269
      size: 2915943647
    outs:
    - path: gr-work-actions-5core.parquet
      md5: a685dbabcdf29a9ca9ed24e1774cf865
      size: 2900522363
  work-ratings-5core:
    cmd: python ../../run.py --rust kcore -o gr-work-ratings-5core.parquet gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: 1687cd58ba626b4585a38ffca547d380
      size: 3490
    - path: gr-work-ratings.parquet
      md5: d9000709e7aee430b230abb118bc9abd
      size: 1427661225
    outs:
    - path: gr-work-ratings-5core.parquet
      md5: 1b0e55ec372ee79abf1723dd13e28532
      size: 1404822316
  cluster-actions-5core:
    cmd: python ../../run.py --rust kcore -o gr-cluster-actions-5core.parquet gr-cluster-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: 1687cd58ba626b4585a38ffca547d380
      size: 3490
    - path: gr-cluster-actions.parquet
      md5: 86e0429f43d387fc86748330704b0734
      size: 2812604300
    outs:
    - path: gr-cluster-actions-5core.parquet
      md5: 10b57aedd0a9c6766d4d7942198939c2
      size: 2797042418
