schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../../run.py --rust goodreads scan interactions ../../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../../src/cli/goodreads
      md5: 9a183d069c3e26425902f894cb7cf4f2.dir
      size: 12357
      nfiles: 4
    - path: ../../src/goodreads
      md5: b71b1bcda391d44638b265f72f2dd63d.dir
      size: 15726
      nfiles: 7
    outs:
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: gr-users.parquet
      md5: ff0d06650a9944bf80cc8c4a99827c1d
      size: 18683237
  schema@gr-interactions:
    cmd: python ../../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    outs:
    - path: gr-interactions.json
      md5: 9b3af7db2bcd5cb7616d6f0a17daefb4
      size: 990
  work-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions --native-works
      -o goodreads/full/gr-work-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: goodreads/gr-book-link.parquet
      md5: a77c14ec887a12bb23845991b937d6b5
      size: 19848706
    - path: src/cli/goodreads/cluster.rs
      md5: e88c9377535f9085c0ecd1eceb49977a
      size: 8167
    outs:
    - path: goodreads/full/gr-work-actions.parquet
      md5: 51dded22312873789f6740fdb848e81e
      size: 3006176388
  schema@gr-work-actions:
    cmd: python ../../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: 51dded22312873789f6740fdb848e81e
      size: 3006176388
    outs:
    - path: gr-work-actions.json
      md5: e2c6f46b44ff679a86ed891182faf00b
      size: 614
  cluster-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings -o goodreads/full/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: goodreads/gr-book-link.parquet
      md5: a77c14ec887a12bb23845991b937d6b5
      size: 19848706
    - path: src/cli/goodreads/cluster.rs
      md5: e88c9377535f9085c0ecd1eceb49977a
      size: 8167
    outs:
    - path: goodreads/full/gr-cluster-ratings.parquet
      md5: 70c6de80c53daeae17d5ce0a096b0363
      size: 1406043866
  schema@gr-cluster-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: 70c6de80c53daeae17d5ce0a096b0363
      size: 1406043866
    outs:
    - path: gr-cluster-ratings.json
      md5: 6a4e0de934689fb6dc6e7f8ca4e99479
      size: 703
  cluster-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions -o goodreads/full/gr-cluster-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: goodreads/gr-book-link.parquet
      md5: a77c14ec887a12bb23845991b937d6b5
      size: 19848706
    - path: src/cli/goodreads/cluster.rs
      md5: e88c9377535f9085c0ecd1eceb49977a
      size: 8167
    outs:
    - path: goodreads/full/gr-cluster-actions.parquet
      md5: 3e3b6fa9d4e78aebe17b214c11ec572f
      size: 2900509473
  schema@gr-cluster-actions:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: 3e3b6fa9d4e78aebe17b214c11ec572f
      size: 2900509473
    outs:
    - path: gr-cluster-actions.json
      md5: f46d06c208ffbb3bc74a22b2e6f1400a
      size: 614
  work-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings --native-works
      -o goodreads/full/gr-work-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: 9788655b2499eb8150398f8c1558e823
      size: 4372045343
    - path: goodreads/gr-book-link.parquet
      md5: a77c14ec887a12bb23845991b937d6b5
      size: 19848706
    - path: src/cli/goodreads/cluster.rs
      md5: e88c9377535f9085c0ecd1eceb49977a
      size: 8167
    outs:
    - path: goodreads/full/gr-work-ratings.parquet
      md5: 4f9295039926c007d23fda7b1b653061
      size: 1471954634
  schema@gr-work-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: 4f9295039926c007d23fda7b1b653061
      size: 1471954634
    outs:
    - path: gr-work-ratings.json
      md5: c883ba08d133875a3ec8bb220d0bd269
      size: 704
  schema@gr-users:
    cmd: python ../../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: ff0d06650a9944bf80cc8c4a99827c1d
      size: 18683237
    outs:
    - path: gr-users.json
      md5: 70a463f659828f45949b5288557788f7
      size: 244
  scan-reviews:
    cmd: python ../../run.py --rust goodreads scan reviews ../../data/goodreads/goodreads_reviews_dedup.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_reviews_dedup.json.gz
      md5: bdd95c4f92691df3d311012254988a1e
      size: 5343299228
    - path: ../../src/cli/goodreads
      md5: 9a183d069c3e26425902f894cb7cf4f2.dir
      size: 12357
      nfiles: 4
    - path: ../../src/goodreads
      md5: b71b1bcda391d44638b265f72f2dd63d.dir
      size: 15726
      nfiles: 7
    outs:
    - path: gr-reviews.parquet
      md5: 821a8a07fcee0d48a359375a2d748cd4
      size: 4349684252
  schema@gr-reviews:
    cmd: python ../../run.py --rust pq-info -o gr-reviews.json gr-reviews.parquet
    deps:
    - path: gr-reviews.parquet
      md5: 821a8a07fcee0d48a359375a2d748cd4
      size: 4349684252
    outs:
    - path: gr-reviews.json
      md5: 79f35e05db2d4470ff710bd5a9d65f6a
      size: 884
  cluster-reviews:
    cmd: python run.py --rust goodreads cluster-interactions --reviews -o goodreads/full/gr-cluster-review-link.parquet
    deps:
    - path: goodreads/full/gr-reviews.parquet
      md5: 821a8a07fcee0d48a359375a2d748cd4
      size: 4349684252
    - path: goodreads/gr-book-link.parquet
      md5: a77c14ec887a12bb23845991b937d6b5
      size: 19848706
    - path: src/cli/goodreads/cluster.rs
      md5: e88c9377535f9085c0ecd1eceb49977a
      size: 8167
    outs:
    - path: goodreads/full/gr-cluster-review-link.parquet
      md5: edfa0b4928f27a22ad348ca3a2262b80
      size: 185719345
