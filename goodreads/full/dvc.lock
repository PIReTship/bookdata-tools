schema: '2.0'
stages:
  scan-interactions:
    cmd: python ../../run.py --rust goodreads scan interactions ../../data/goodreads/goodreads_interactions.json.gz
    deps:
    - path: ../../data/goodreads/goodreads_interactions.json.gz
      md5: f2d054a85f33d405a9bff6933005ba89
      size: 9388113365
    - path: ../../src/cli/goodreads
      md5: 3cb95483e14880f6e62ce8529579d7ef.dir
      size: 12116
      nfiles: 4
    - path: ../../src/goodreads
      md5: 49baa19c011307b48ca3fb6e29c777d6.dir
      size: 17036
      nfiles: 7
    outs:
    - path: gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: gr-users.parquet
      md5: 25cbde2dbce33211b73bdcb80b74b142
      size: 18613573
  schema@gr-interactions:
    cmd: python ../../run.py --rust pq-info -o gr-interactions.json gr-interactions.parquet
    deps:
    - path: gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    outs:
    - path: gr-interactions.json
      md5: 7cc12504c0217ddfb85a1eba578814fb
      size: 990
  work-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions --native-works
      -o goodreads/full/gr-work-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 6eeb2145b31d1f5d5377f54f483cd915
      size: 7417
    outs:
    - path: goodreads/full/gr-work-actions.parquet
      md5: 2961c494eeaf8c1e2cdfab7e80591bc0
      size: 3311666297
  schema@gr-work-actions:
    cmd: python ../../run.py --rust pq-info -o gr-work-actions.json gr-work-actions.parquet
    deps:
    - path: gr-work-actions.parquet
      md5: 2961c494eeaf8c1e2cdfab7e80591bc0
      size: 3311666297
    outs:
    - path: gr-work-actions.json
      md5: 4f4189646bc4d7c2cad3987906d5a46f
      size: 614
  cluster-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings -o goodreads/full/gr-cluster-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 6eeb2145b31d1f5d5377f54f483cd915
      size: 7417
    outs:
    - path: goodreads/full/gr-cluster-ratings.parquet
      md5: d2a9dcd70548f47a2dfabc8542e686d6
      size: 1524512078
  schema@gr-cluster-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-ratings.json gr-cluster-ratings.parquet
    deps:
    - path: gr-cluster-ratings.parquet
      md5: d2a9dcd70548f47a2dfabc8542e686d6
      size: 1524512078
    outs:
    - path: gr-cluster-ratings.json
      md5: e355a770b5da94312367e3837531a810
      size: 703
  cluster-actions:
    cmd: python run.py --rust goodreads cluster-interactions --add-actions -o goodreads/full/gr-cluster-actions.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 6eeb2145b31d1f5d5377f54f483cd915
      size: 7417
    outs:
    - path: goodreads/full/gr-cluster-actions.parquet
      md5: 092025d4a40a676e9d1f244c2f2e0dd4
      size: 3162245699
  schema@gr-cluster-actions:
    cmd: python ../../run.py --rust pq-info -o gr-cluster-actions.json gr-cluster-actions.parquet
    deps:
    - path: gr-cluster-actions.parquet
      md5: 092025d4a40a676e9d1f244c2f2e0dd4
      size: 3162245699
    outs:
    - path: gr-cluster-actions.json
      md5: c0752edb427cbb92e979ee3a7a734dc3
      size: 614
  work-ratings:
    cmd: python run.py --rust goodreads cluster-interactions --ratings --native-works
      -o goodreads/full/gr-work-ratings.parquet
    deps:
    - path: goodreads/full/gr-interactions.parquet
      md5: ca6f1e6b5d7073d03eaa5a75f3eb31d9
      size: 4378630184
    - path: goodreads/gr-book-link.parquet
      md5: 17c43318b93c22563377f71b2ee45a1e
      size: 19787709
    - path: src/cli/goodreads/cluster.rs
      md5: 6eeb2145b31d1f5d5377f54f483cd915
      size: 7417
    outs:
    - path: goodreads/full/gr-work-ratings.parquet
      md5: 816dbec357132a065cc5db5cd248331a
      size: 1596404093
  schema@gr-work-ratings:
    cmd: python ../../run.py --rust pq-info -o gr-work-ratings.json gr-work-ratings.parquet
    deps:
    - path: gr-work-ratings.parquet
      md5: 816dbec357132a065cc5db5cd248331a
      size: 1596404093
    outs:
    - path: gr-work-ratings.json
      md5: 805852c1e2e4b54873ba9cd23205bf04
      size: 704
  schema@gr-users:
    cmd: python ../../run.py --rust pq-info -o gr-users.json gr-users.parquet
    deps:
    - path: gr-users.parquet
      md5: 25cbde2dbce33211b73bdcb80b74b142
      size: 18613573
    outs:
    - path: gr-users.json
      md5: cd33f9936cb1ef3a5819c8ae24e1f110
      size: 244
  cluster-ratings-5core:
    cmd: python ../../run.py --rust kcore -o gr-cluster-ratings-5core.parquet gr-cluster-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-cluster-ratings.parquet
      md5: d2a9dcd70548f47a2dfabc8542e686d6
      size: 1524512078
    outs:
    - path: gr-cluster-ratings-5core.parquet
      md5: ca0eb6158948b8785fa400cd1893900d
      size: 1499236320
  work-actions-5core:
    cmd: python ../../run.py --rust kcore -o gr-work-actions-5core.parquet gr-work-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-work-actions.parquet
      md5: 2961c494eeaf8c1e2cdfab7e80591bc0
      size: 3311666297
    outs:
    - path: gr-work-actions-5core.parquet
      md5: 4f705c1fcebb6ac4c8437a724fbb91b3
      size: 3294195548
  work-ratings-5core:
    cmd: python ../../run.py --rust kcore -o gr-work-ratings-5core.parquet gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-work-ratings.parquet
      md5: 816dbec357132a065cc5db5cd248331a
      size: 1596404093
    outs:
    - path: gr-work-ratings-5core.parquet
      md5: cba1af1f207064eec9e6f2ce39775c4c
      size: 1571233691
  cluster-actions-5core:
    cmd: python ../../run.py --rust kcore -o gr-cluster-actions-5core.parquet gr-cluster-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-cluster-actions.parquet
      md5: 092025d4a40a676e9d1f244c2f2e0dd4
      size: 3162245699
    outs:
    - path: gr-cluster-actions-5core.parquet
      md5: 20567bade0fec0076d4f48a45f953fb8
      size: 3144940468
  work-ratings-2015-10core:
    cmd: python ../../run.py --rust kcore -k 10 --year 2015 -o gr-work-ratings-2015-10core.parquet
      gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: 42098b11c9ae3c416c454b192bde4359
      size: 4083
    - path: gr-work-ratings.parquet
      md5: 816dbec357132a065cc5db5cd248331a
      size: 1596404093
    outs:
    - path: gr-work-ratings-2015-10core.parquet
      md5: a694f7e99670ad404dc1360f4da26075
      size: 181176934
  work-actions-2015-100-10core:
    cmd: python ../../run.py --rust kcore --user-k 10 --item-k 100 --year 2015 -o
      gr-work-actions-2015-100-10core.parquet gr-work-actions.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-work-actions.parquet
      md5: 2961c494eeaf8c1e2cdfab7e80591bc0
      size: 3311666297
    outs:
    - path: gr-work-actions-2015-100-10core.parquet
      md5: d80f69e6e18a82837a07eacba2083606
      size: 349120065
  work-ratings-2015-100-10core:
    cmd: python ../../run.py --rust kcore --user-k 10 --item-k 100 --year 2015 -o
      gr-work-ratings-2015-100-10core.parquet gr-work-ratings.parquet
    deps:
    - path: ../../src/cli/kcore.rs
      md5: cedb12dd297cd4d7ee2f4e13fd3deadc
      size: 4446
    - path: gr-work-ratings.parquet
      md5: 816dbec357132a065cc5db5cd248331a
      size: 1596404093
    outs:
    - path: gr-work-ratings-2015-100-10core.parquet
      md5: 4278235b61eecb8b4a65834475da060a
      size: 123816044
