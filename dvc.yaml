stages:
  ClusterStats:
    cmd: quarto render ClusterStats.qmd --to html
    deps:
      - ClusterStats.qmd
      - book-links/cluster-stats.parquet
    outs:
      - ClusterStats.ipynb:
          cache: false
      - ClusterStats.html
      - ClusterStats_files
  LinkageStats:
    cmd: quarto render LinkageStats.qmd --to html
    deps:
      - LinkageStats.qmd
      - book-links/gender-stats.csv
    outs:
      - LinkageStats.ipynb:
          cache: false
      - LinkageStats.html
      - LinkageStats_files
  schema:
    foreach:
      - az2014/az-cluster-ratings
      - az2014/az-cluster-ratings-5core
      - az2014/ratings
      - az2018/az-cluster-ratings
      - az2018/az-cluster-ratings-5core
      - az2018/ratings
      - book-links/isbn-clusters
      - book-links/cluster-stats
      - book-links/cluster-graph-nodes
      - book-links/cluster-graph-edges
      - book-links/cluster-first-authors
      - book-links/cluster-genders
      - book-links/cluster-hashes
      - book-links/cluster-loc-first-authors
      - book-links/cluster-ol-first-authors
      - book-links/all-isbns
      - bx/bx-cluster-actions
      - bx/bx-cluster-ratings
      - goodreads/book-isbn-ids
      - goodreads/gr-book-link
      - goodreads/gr-author-info
      - goodreads/gr-book-genres
      - goodreads/gr-genres
      - goodreads/gr-book-ids
      - goodreads/gr-book-info
      - goodreads/gr-book-authors
      - goodreads/gr-book-series
      - goodreads/gr-work-info
      - goodreads/gr-work-gender
      - goodreads/simple/gr-cluster-actions
      - goodreads/simple/gr-cluster-actions-5core
      - goodreads/simple/gr-cluster-ratings
      - goodreads/simple/gr-cluster-ratings-5core
      - goodreads/simple/gr-interactions
      - goodreads/simple/gr-work-actions
      - goodreads/simple/gr-work-actions-5core
      - goodreads/simple/gr-work-ratings
      - goodreads/simple/gr-work-ratings-5core
      - loc-mds/book-isbn-ids
      - loc-mds/book-fields
      - loc-mds/book-ids
      - loc-mds/book-isbns
      - loc-mds/book-authors
      - loc-mds/name-fields
      - openlibrary/edition-isbn-ids
      - openlibrary/authors
      - openlibrary/author-names
      - openlibrary/editions
      - openlibrary/edition-works
      - openlibrary/edition-isbns
      - openlibrary/edition-authors
      - openlibrary/edition-subjects
      - openlibrary/all-works
      - openlibrary/all-authors
      - openlibrary/works
      - openlibrary/work-authors
      - openlibrary/work-subjects
      - openlibrary/author-ids-after-works
      - openlibrary/work-clusters
      - viaf/author-genders
      - viaf/author-name-index
      - viaf/viaf
    do:
      cmd: "cargo run --release -- pq-info -o ${item}.json ${item}.parquet"
      deps:
        - "${item}.parquet"
      outs:
        - "${item}.json":
            cache: false